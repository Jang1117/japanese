<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>히라가나 따라쓰기</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
            max-width: 500px;
            width: 100%;
        }

        h1 {
            color: #667eea;  /* 히라가나는 #667eea, 문장연습은 #4facfe */
            font-size: 24px;
            flex: none;      /* flex: 1에서 flex: none으로 */
        }

        .header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .back-button {
            background: #e9ecef;
            border: none;
            border-radius: 8px;
            padding: 0;                    /* padding을 0으로 */
            width: 36px;
            height: 36px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            transition: all 0.3s;
            flex-shrink: 0;
            display: flex;                 /* 추가 */
            align-items: center;           /* 추가 */
            justify-content: center;       /* 추가 */
            min-width: 36px;               /* 추가 */
            max-width: 36px;               /* 추가 */
        }

        .back-button:hover {
            background: #dee2e6;
            transform: translateX(-3px);
        }

        .character-display {
            text-align: center;
            margin-bottom: 20px;
        }

        .current-character {
            font-size: 80px;
            color: #764ba2;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .character-info {
            font-size: 18px;
            color: #666;
        }

        .canvas-container {
            position: relative;
            background: #f8f9fa;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid #e0e0e0;
            overflow: hidden;
        }

        #drawingCanvas {
            display: block;
            width: 100%;
            height: 300px;
            cursor: crosshair;
            touch-action: none;
        }

        .guide-canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            opacity: 0;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-clear {
            background: #ff6b6b;
            color: white;
        }

        .btn-clear:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        .btn-next {
            background: #51cf66;
            color: white;
        }

        .btn-next:hover {
            background: #40c057;
            transform: translateY(-2px);
        }

        .btn-show-guide {
            background: #ffd43b;
            color: #333;
        }

        .btn-show-guide:hover {
            background: #fcc419;
            transform: translateY(-2px);
        }

        .progress {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .category-selector {
            display: flex;
            gap: 6px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .category-btn {
            flex: 1 1 calc(16.666% - 6px);
            min-width: 65px;
            padding: 8px 4px;
            background: #e9ecef;
            color: #495057;
            border: 2px solid transparent;
            font-size: 13px;
        }

        .category-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .stroke-order {
            text-align: center;
            margin-top: 10px;
            padding: 10px;
            background: #e7f5ff;
            border-radius: 8px;
            font-size: 14px;
            color: #1864ab;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="back-button" onclick="goBack()">←</button>
            <h1>✏️ 히라가나 따라쓰기</h1>
        </div>
        
        <div class="category-selector">
            <button class="category-btn active" onclick="selectCategory('basic')">あ행</button>
            <button class="category-btn" onclick="selectCategory('ka')">か행</button>
            <button class="category-btn" onclick="selectCategory('sa')">さ행</button>
            <button class="category-btn" onclick="selectCategory('ta')">た행</button>
            <button class="category-btn" onclick="selectCategory('na')">な행</button>
            <button class="category-btn" onclick="selectCategory('ha')">は행</button>
            <button class="category-btn" onclick="selectCategory('ma')">ま행</button>
            <button class="category-btn" onclick="selectCategory('ya')">や행</button>
            <button class="category-btn" onclick="selectCategory('ra')">ら행</button>
            <button class="category-btn" onclick="selectCategory('wa')">わ행</button>
            <button class="category-btn" onclick="selectCategory('ga')">탁음 が</button>
            <button class="category-btn" onclick="selectCategory('za')">탁음 ざ</button>
            <button class="category-btn" onclick="selectCategory('da')">탁음 だ</button>
            <button class="category-btn" onclick="selectCategory('ba')">탁음 ば</button>
            <button class="category-btn" onclick="selectCategory('pa')">반탁음 ぱ</button>
            <button class="category-btn" onclick="selectCategory('kya')">요음 きゃ</button>
            <button class="category-btn" onclick="selectCategory('sha')">요음 しゃ</button>
            <button class="category-btn" onclick="selectCategory('cha')">요음 ちゃ</button>
            <button class="category-btn" onclick="selectCategory('nya')">요음 にゃ</button>
            <button class="category-btn" onclick="selectCategory('hya')">요음 ひゃ</button>
            <button class="category-btn" onclick="selectCategory('mya')">요음 みゃ</button>
            <button class="category-btn" onclick="selectCategory('rya')">요음 りゃ</button>
            <button class="category-btn" onclick="selectCategory('gya')">요음 ぎゃ</button>
            <button class="category-btn" onclick="selectCategory('ja')">요음 じゃ</button>
            <button class="category-btn" onclick="selectCategory('bya')">요음 びゃ</button>
            <button class="category-btn" onclick="selectCategory('pya')">요음 ぴゃ</button>
        </div>

        <div class="progress">
            <span id="progressText">1 / 5</span>
        </div>

        <div class="character-display">
            <div class="current-character" id="currentCharacter">あ</div>
            <div class="character-info" id="characterInfo">a (아)</div>
        </div>

        <div class="canvas-container">
            <canvas id="guideCanvas" class="guide-canvas"></canvas>
            <canvas id="drawingCanvas"></canvas>
        </div>

        <div class="stroke-order" id="strokeOrder">
            획순: 왼쪽에서 오른쪽으로, 위에서 아래로
        </div>

        <div class="controls">
            <button class="btn-clear" onclick="clearCanvas()">지우기</button>
            <button class="btn-show-guide" onclick="toggleGuide()">가이드</button>
            <button class="btn-next" onclick="nextCharacter()">다음</button>
        </div>
    </div>

    <script>
        const hiraganaData = {
            basic: [
                { char: 'あ', romaji: 'a', korean: '아', strokes: '3획: ① 위 가로 획 → ② 오른쪽 세로+곡선 획 → ③ 왼쪽 곡선 획', 
                  strokeOrder: [[0.25, 0.25, 0.65, 0.28], [0.55, 0.25, 0.58, 0.75], [0.28, 0.45, 0.42, 0.78]] },
                { char: 'い', romaji: 'i', korean: '이', strokes: '2획: ① 왼쪽 세로 획 → ② 오른쪽 세로 획', 
                  strokeOrder: [[0.38, 0.28, 0.35, 0.72], [0.62, 0.23, 0.65, 0.75]] },
                { char: 'う', romaji: 'u', korean: '우', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.30, 0.35, 0.55, 0.35], [0.40, 0.50, 0.60, 0.72]] },
                { char: 'え', romaji: 'e', korean: '에', strokes: '2획: ① 위에서 아래로 곡선 획 → ② 아래 가로 획', 
                  strokeOrder: [[0.30, 0.32, 0.62, 0.58], [0.32, 0.68, 0.68, 0.68]] },
                { char: 'お', romaji: 'o', korean: '오', strokes: '3획: ① 위 가로 획 → ② 세로 획 → ③ 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.28, 0.62, 0.28], [0.45, 0.28, 0.45, 0.48], [0.32, 0.52, 0.62, 0.75]] }
            ],
            ka: [
                { char: 'か', romaji: 'ka', korean: '카', strokes: '3획: ① 위 가로 획 → ② 세로 획 → ③ 오른쪽 사선 획', 
                  strokeOrder: [[0.28, 0.28, 0.58, 0.32], [0.42, 0.32, 0.42, 0.72], [0.55, 0.48, 0.65, 0.75]] },
                { char: 'き', romaji: 'ki', korean: '키', strokes: '4획: ① 위 가로 획 → ② 왼쪽 세로 획 → ③ 오른쪽 위 사선 → ④ 오른쪽 아래 사선', 
                  strokeOrder: [[0.32, 0.28, 0.48, 0.28], [0.38, 0.28, 0.38, 0.72], [0.50, 0.38, 0.68, 0.48], [0.50, 0.55, 0.68, 0.68]] },
                { char: 'く', romaji: 'ku', korean: '쿠', strokes: '1획: ① 위에서 아래로 곡선 획', 
                  strokeOrder: [[0.32, 0.32, 0.65, 0.68]] },
                { char: 'け', romaji: 'ke', korean: '케', strokes: '3획: ① 위 가로 획 → ② 세로 획 → ③ 오른쪽 사선 획', 
                  strokeOrder: [[0.28, 0.28, 0.55, 0.32], [0.38, 0.32, 0.38, 0.72], [0.50, 0.48, 0.68, 0.68]] },
                { char: 'こ', romaji: 'ko', korean: '코', strokes: '2획: ① 위 가로 획 → ② 아래 가로 획', 
                  strokeOrder: [[0.32, 0.35, 0.62, 0.35], [0.38, 0.52, 0.65, 0.65]] }
            ],
            sa: [
                { char: 'さ', romaji: 'sa', korean: '사', strokes: '3획: ① 위 가로 획 → ② 중간 가로 획 → ③ 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.28, 0.62, 0.32], [0.38, 0.45, 0.58, 0.48], [0.35, 0.60, 0.65, 0.75]] },
                { char: 'し', romaji: 'shi', korean: '시', strokes: '1획: ① 위에서 아래로 곡선 획', 
                  strokeOrder: [[0.38, 0.28, 0.58, 0.75]] },
                { char: 'す', romaji: 'su', korean: '스', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.35, 0.58, 0.38], [0.38, 0.50, 0.65, 0.72]] },
                { char: 'せ', romaji: 'se', korean: '세', strokes: '3획: ① 위 가로 획 → ② 중간 가로 획 → ③ 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.32, 0.58, 0.32], [0.32, 0.48, 0.65, 0.52], [0.38, 0.65, 0.65, 0.75]] },
                { char: 'そ', romaji: 'so', korean: '소', strokes: '1획: ① 위에서 아래로 곡선 획', 
                  strokeOrder: [[0.32, 0.28, 0.65, 0.72]] }
            ],
            ta: [
                { char: 'た', romaji: 'ta', korean: '타', strokes: '4획: ① 맨 위 가로 획 → ② 세로 획 → ③ 중간 가로 획 → ④ 아래 세로 획', 
                  strokeOrder: [[0.28, 0.28, 0.62, 0.28], [0.45, 0.28, 0.45, 0.48], [0.32, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] },
                { char: 'ち', romaji: 'chi', korean: '치', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.32, 0.28, 0.58, 0.32], [0.38, 0.45, 0.62, 0.75]] },
                { char: 'つ', romaji: 'tsu', korean: '츠', strokes: '1획: ① 왼쪽에서 오른쪽으로 곡선 획', 
                  strokeOrder: [[0.32, 0.42, 0.65, 0.68]] },
                { char: 'て', romaji: 'te', korean: '테', strokes: '1획: ① 왼쪽 위에서 오른쪽 아래로 곡선 획', 
                  strokeOrder: [[0.32, 0.32, 0.65, 0.72]] },
                { char: 'と', romaji: 'to', korean: '토', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.32, 0.28, 0.58, 0.32], [0.38, 0.48, 0.65, 0.72]] }
            ],
            na: [
                { char: 'な', romaji: 'na', korean: '나', strokes: '4획: ① 맨 위 가로 획 → ② 왼쪽 세로 획 → ③ 중간 가로 획 → ④ 오른쪽 세로 획', 
                  strokeOrder: [[0.28, 0.28, 0.58, 0.28], [0.42, 0.28, 0.42, 0.48], [0.28, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] },
                { char: 'に', romaji: 'ni', korean: '니', strokes: '3획: ① 위 가로 획 → ② 아래 가로 획 → ③ 오른쪽 세로 획', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.28, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] },
                { char: 'ぬ', romaji: 'nu', korean: '누', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.32, 0.58, 0.38], [0.38, 0.48, 0.65, 0.75]] },
                { char: 'ね', romaji: 'ne', korean: '네', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.32, 0.52, 0.38], [0.35, 0.48, 0.65, 0.75]] },
                { char: 'の', romaji: 'no', korean: '노', strokes: '1획: ① 나선형 곡선 획 (한 붓 그리기)', 
                  strokeOrder: [[0.32, 0.28, 0.65, 0.72]] }
            ],
            ha: [
                { char: 'は', romaji: 'ha', korean: '하', strokes: '3획: ① 왼쪽 위 가로 획 → ② 왼쪽 세로 획 → ③ 오른쪽 곡선 획', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.32, 0.38, 0.72], [0.52, 0.38, 0.68, 0.75]] },
                { char: 'ひ', romaji: 'hi', korean: '히', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'ふ', romaji: 'fu', korean: '후', strokes: '4획: ① 왼쪽 위 점 → ② 위 가로 획 → ③ 중간 가로 획 → ④ 아래 세로 획', 
                  strokeOrder: [[0.28, 0.28, 0.42, 0.32], [0.32, 0.38, 0.58, 0.42], [0.48, 0.48, 0.65, 0.58], [0.42, 0.65, 0.58, 0.75]] },
                { char: 'へ', romaji: 'he', korean: '헤', strokes: '1획: ① 왼쪽에서 오른쪽으로 사선 획', 
                  strokeOrder: [[0.32, 0.42, 0.65, 0.62]] },
                { char: 'ほ', romaji: 'ho', korean: '호', strokes: '4획: ① 맨 위 가로 획 → ② 왼쪽 세로 획 → ③ 중간 가로 획 → ④ 오른쪽 세로 획', 
                  strokeOrder: [[0.28, 0.28, 0.55, 0.28], [0.42, 0.28, 0.42, 0.48], [0.28, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] }
            ],
            ma: [
                { char: 'ま', romaji: 'ma', korean: '마', strokes: '3획: ① 위 가로 획 → ② 세로 획 → ③ 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.28, 0.62, 0.28], [0.45, 0.28, 0.45, 0.48], [0.32, 0.52, 0.65, 0.75]] },
                { char: 'み', romaji: 'mi', korean: '미', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.38, 0.48, 0.65, 0.75]] },
                { char: 'む', romaji: 'mu', korean: '무', strokes: '3획: ① 위 가로 획 → ② 중간 가로 획 → ③ 아래 세로 획', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.28, 0.42, 0.65, 0.48], [0.42, 0.55, 0.58, 0.75]] },
                { char: 'め', romaji: 'me', korean: '메', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.38, 0.48, 0.65, 0.75]] },
                { char: 'も', romaji: 'mo', korean: '모', strokes: '3획: ① 위 가로 획 → ② 중간 가로 획 → ③ 아래 세로 획', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.28, 0.48, 0.65, 0.52], [0.42, 0.60, 0.52, 0.75]] }
            ],
            ya: [
                { char: 'や', romaji: 'ya', korean: '야', strokes: '3획: ① 위 가로 획 → ② 중간 가로 획 → ③ 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.28, 0.62, 0.32], [0.38, 0.48, 0.58, 0.52], [0.35, 0.65, 0.65, 0.75]] },
                { char: 'ゆ', romaji: 'yu', korean: '유', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.32, 0.52, 0.38], [0.38, 0.48, 0.65, 0.75]] },
                { char: 'よ', romaji: 'yo', korean: '요', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.32, 0.32, 0.62, 0.38], [0.38, 0.52, 0.65, 0.75]] }
            ],
            ra: [
                { char: 'ら', romaji: 'ra', korean: '라', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.75]] },
                { char: 'り', romaji: 'ri', korean: '리', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.75]] },
                { char: 'る', romaji: 'ru', korean: '루', strokes: '1획: ① 위에서 아래로 나선형 곡선 획', 
                  strokeOrder: [[0.32, 0.32, 0.65, 0.75]] },
                { char: 'れ', romaji: 're', korean: '레', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.32, 0.58, 0.38], [0.38, 0.48, 0.65, 0.75]] },
                { char: 'ろ', romaji: 'ro', korean: '로', strokes: '3획: ① 위 가로 획 → ② 중간 가로 획 → ③ 아래 세로 획', 
                  strokeOrder: [[0.32, 0.28, 0.58, 0.28], [0.28, 0.42, 0.65, 0.48], [0.42, 0.55, 0.52, 0.75]] }
            ],
            wa: [
                { char: 'わ', romaji: 'wa', korean: '와', strokes: '2획: ① 위 가로 획 → ② 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.32, 0.62, 0.38], [0.38, 0.48, 0.65, 0.75]] },
                { char: 'を', romaji: 'wo/o', korean: '오(조사)', strokes: '3획: ① 위 가로 획 → ② 중간 가로 획 → ③ 아래 곡선 획', 
                  strokeOrder: [[0.28, 0.28, 0.62, 0.32], [0.38, 0.48, 0.58, 0.52], [0.35, 0.65, 0.65, 0.75]] },
                { char: 'ん', romaji: 'n', korean: '응', strokes: '1획: ① 왼쪽에서 오른쪽으로 곡선 획', 
                  strokeOrder: [[0.32, 0.42, 0.65, 0.72]] }
            ],
            // 탁음 (Dakuten)
            ga: [
                { char: 'が', romaji: 'ga', korean: '가', strokes: '3획 + 탁점', 
                  strokeOrder: [[0.28, 0.28, 0.58, 0.32], [0.42, 0.32, 0.42, 0.72], [0.55, 0.48, 0.65, 0.75]] },
                { char: 'ぎ', romaji: 'gi', korean: '기', strokes: '4획 + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.48, 0.28], [0.38, 0.28, 0.38, 0.72], [0.50, 0.38, 0.68, 0.48], [0.50, 0.55, 0.68, 0.68]] },
                { char: 'ぐ', romaji: 'gu', korean: '구', strokes: '1획 + 탁점', 
                  strokeOrder: [[0.32, 0.32, 0.65, 0.68]] },
                { char: 'げ', romaji: 'ge', korean: '게', strokes: '3획 + 탁점', 
                  strokeOrder: [[0.28, 0.28, 0.55, 0.32], [0.38, 0.32, 0.38, 0.72], [0.50, 0.48, 0.68, 0.68]] },
                { char: 'ご', romaji: 'go', korean: '고', strokes: '2획 + 탁점', 
                  strokeOrder: [[0.32, 0.35, 0.62, 0.35], [0.38, 0.52, 0.65, 0.65]] }
            ],
            za: [
                { char: 'ざ', romaji: 'za', korean: '자', strokes: '3획 + 탁점', 
                  strokeOrder: [[0.28, 0.28, 0.62, 0.32], [0.38, 0.45, 0.58, 0.48], [0.35, 0.60, 0.65, 0.75]] },
                { char: 'じ', romaji: 'ji', korean: '지', strokes: '1획 + 탁점', 
                  strokeOrder: [[0.38, 0.28, 0.58, 0.75]] },
                { char: 'ず', romaji: 'zu', korean: '즈', strokes: '2획 + 탁점', 
                  strokeOrder: [[0.28, 0.35, 0.58, 0.38], [0.38, 0.50, 0.65, 0.72]] },
                { char: 'ぜ', romaji: 'ze', korean: '제', strokes: '3획 + 탁점', 
                  strokeOrder: [[0.28, 0.32, 0.58, 0.32], [0.32, 0.48, 0.65, 0.52], [0.38, 0.65, 0.65, 0.75]] },
                { char: 'ぞ', romaji: 'zo', korean: '조', strokes: '1획 + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.65, 0.72]] }
            ],
            da: [
                { char: 'だ', romaji: 'da', korean: '다', strokes: '4획 + 탁점', 
                  strokeOrder: [[0.28, 0.28, 0.62, 0.28], [0.45, 0.28, 0.45, 0.48], [0.32, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] },
                { char: 'ぢ', romaji: 'ji', korean: '지', strokes: '2획 + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.58, 0.32], [0.38, 0.45, 0.62, 0.75]] },
                { char: 'づ', romaji: 'zu', korean: '즈', strokes: '1획 + 탁점', 
                  strokeOrder: [[0.32, 0.42, 0.65, 0.68]] },
                { char: 'で', romaji: 'de', korean: '데', strokes: '1획 + 탁점', 
                  strokeOrder: [[0.32, 0.32, 0.65, 0.72]] },
                { char: 'ど', romaji: 'do', korean: '도', strokes: '2획 + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.58, 0.32], [0.38, 0.48, 0.65, 0.72]] }
            ],
            ba: [
                { char: 'ば', romaji: 'ba', korean: '바', strokes: '3획 + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.32, 0.38, 0.72], [0.52, 0.38, 0.68, 0.75]] },
                { char: 'び', romaji: 'bi', korean: '비', strokes: '2획 + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'ぶ', romaji: 'bu', korean: '부', strokes: '4획 + 탁점', 
                  strokeOrder: [[0.28, 0.28, 0.42, 0.32], [0.32, 0.38, 0.58, 0.42], [0.48, 0.48, 0.65, 0.58], [0.42, 0.65, 0.58, 0.75]] },
                { char: 'べ', romaji: 'be', korean: '베', strokes: '1획 + 탁점', 
                  strokeOrder: [[0.32, 0.42, 0.65, 0.62]] },
                { char: 'ぼ', romaji: 'bo', korean: '보', strokes: '4획 + 탁점', 
                  strokeOrder: [[0.28, 0.28, 0.55, 0.28], [0.42, 0.28, 0.42, 0.48], [0.28, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] }
            ],
            // 반탁음 (Handakuten)
            pa: [
                { char: 'ぱ', romaji: 'pa', korean: '파', strokes: '3획 + 반탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.32, 0.38, 0.72], [0.52, 0.38, 0.68, 0.75]] },
                { char: 'ぴ', romaji: 'pi', korean: '피', strokes: '2획 + 반탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'ぷ', romaji: 'pu', korean: '푸', strokes: '4획 + 반탁점', 
                  strokeOrder: [[0.28, 0.28, 0.42, 0.32], [0.32, 0.38, 0.58, 0.42], [0.48, 0.48, 0.65, 0.58], [0.42, 0.65, 0.58, 0.75]] },
                { char: 'ぺ', romaji: 'pe', korean: '페', strokes: '1획 + 반탁점', 
                  strokeOrder: [[0.32, 0.42, 0.65, 0.62]] },
                { char: 'ぽ', romaji: 'po', korean: '포', strokes: '4획 + 반탁점', 
                  strokeOrder: [[0.28, 0.28, 0.55, 0.28], [0.42, 0.28, 0.42, 0.48], [0.28, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] }
            ],
            // 요음 (Yoon)
            kya: [
                { char: 'きゃ', romaji: 'kya', korean: '챠', strokes: 'き + 작은 ゃ', 
                  strokeOrder: [[0.32, 0.28, 0.48, 0.28], [0.38, 0.28, 0.38, 0.72], [0.50, 0.38, 0.68, 0.48]] },
                { char: 'きゅ', romaji: 'kyu', korean: '큐', strokes: 'き + 작은 ゅ', 
                  strokeOrder: [[0.32, 0.28, 0.48, 0.28], [0.38, 0.28, 0.38, 0.72], [0.50, 0.38, 0.68, 0.48]] },
                { char: 'きょ', romaji: 'kyo', korean: '쿄', strokes: 'き + 작은 ょ', 
                  strokeOrder: [[0.32, 0.28, 0.48, 0.28], [0.38, 0.28, 0.38, 0.72], [0.50, 0.38, 0.68, 0.48]] }
            ],
            sha: [
                { char: 'しゃ', romaji: 'sha', korean: '샤', strokes: 'し + 작은 ゃ', 
                  strokeOrder: [[0.38, 0.28, 0.58, 0.75]] },
                { char: 'しゅ', romaji: 'shu', korean: '슈', strokes: 'し + 작은 ゅ', 
                  strokeOrder: [[0.38, 0.28, 0.58, 0.75]] },
                { char: 'しょ', romaji: 'sho', korean: '쇼', strokes: 'し + 작은 ょ', 
                  strokeOrder: [[0.38, 0.28, 0.58, 0.75]] }
            ],
            cha: [
                { char: 'ちゃ', romaji: 'cha', korean: '차', strokes: 'ち + 작은 ゃ', 
                  strokeOrder: [[0.32, 0.28, 0.58, 0.32], [0.38, 0.45, 0.62, 0.75]] },
                { char: 'ちゅ', romaji: 'chu', korean: '추', strokes: 'ち + 작은 ゅ', 
                  strokeOrder: [[0.32, 0.28, 0.58, 0.32], [0.38, 0.45, 0.62, 0.75]] },
                { char: 'ちょ', romaji: 'cho', korean: '초', strokes: 'ち + 작은 ょ', 
                  strokeOrder: [[0.32, 0.28, 0.58, 0.32], [0.38, 0.45, 0.62, 0.75]] }
            ],
            nya: [
                { char: 'にゃ', romaji: 'nya', korean: '냐', strokes: 'に + 작은 ゃ', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.28, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] },
                { char: 'にゅ', romaji: 'nyu', korean: '뉴', strokes: 'に + 작은 ゅ', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.28, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] },
                { char: 'にょ', romaji: 'nyo', korean: '뇨', strokes: 'に + 작은 ょ', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.28, 0.55, 0.65, 0.60], [0.48, 0.60, 0.48, 0.75]] }
            ],
            hya: [
                { char: 'ひゃ', romaji: 'hya', korean: '햐', strokes: 'ひ + 작은 ゃ', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'ひゅ', romaji: 'hyu', korean: '휴', strokes: 'ひ + 작은 ゅ', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'ひょ', romaji: 'hyo', korean: '효', strokes: 'ひ + 작은 ょ', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] }
            ],
            mya: [
                { char: 'みゃ', romaji: 'mya', korean: '먀', strokes: 'み + 작은 ゃ', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.38, 0.48, 0.65, 0.75]] },
                { char: 'みゅ', romaji: 'myu', korean: '뮤', strokes: 'み + 작은 ゅ', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.38, 0.48, 0.65, 0.75]] },
                { char: 'みょ', romaji: 'myo', korean: '묘', strokes: 'み + 작은 ょ', 
                  strokeOrder: [[0.32, 0.32, 0.58, 0.38], [0.38, 0.48, 0.65, 0.75]] }
            ],
            rya: [
                { char: 'りゃ', romaji: 'rya', korean: '랴', strokes: 'り + 작은 ゃ', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.75]] },
                { char: 'りゅ', romaji: 'ryu', korean: '류', strokes: 'り + 작은 ゅ', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.75]] },
                { char: 'りょ', romaji: 'ryo', korean: '료', strokes: 'り + 작은 ょ', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.75]] }
            ],
            gya: [
                { char: 'ぎゃ', romaji: 'gya', korean: '갸', strokes: 'ぎ + 작은 ゃ + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.48, 0.28], [0.38, 0.28, 0.38, 0.72], [0.50, 0.38, 0.68, 0.48]] },
                { char: 'ぎゅ', romaji: 'gyu', korean: '규', strokes: 'ぎ + 작은 ゅ + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.48, 0.28], [0.38, 0.28, 0.38, 0.72], [0.50, 0.38, 0.68, 0.48]] },
                { char: 'ぎょ', romaji: 'gyo', korean: '교', strokes: 'ぎ + 작은 ょ + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.48, 0.28], [0.38, 0.28, 0.38, 0.72], [0.50, 0.38, 0.68, 0.48]] }
            ],
            ja: [
                { char: 'じゃ', romaji: 'ja', korean: '자', strokes: 'じ + 작은 ゃ + 탁점', 
                  strokeOrder: [[0.38, 0.28, 0.58, 0.75]] },
                { char: 'じゅ', romaji: 'ju', korean: '주', strokes: 'じ + 작은 ゅ + 탁점', 
                  strokeOrder: [[0.38, 0.28, 0.58, 0.75]] },
                { char: 'じょ', romaji: 'jo', korean: '조', strokes: 'じ + 작은 ょ + 탁점', 
                  strokeOrder: [[0.38, 0.28, 0.58, 0.75]] }
            ],
            bya: [
                { char: 'びゃ', romaji: 'bya', korean: '뱌', strokes: 'び + 작은 ゃ + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'びゅ', romaji: 'byu', korean: '뷰', strokes: 'び + 작은 ゅ + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'びょ', romaji: 'byo', korean: '뵤', strokes: 'び + 작은 ょ + 탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] }
            ],
            pya: [
                { char: 'ぴゃ', romaji: 'pya', korean: '퍄', strokes: 'ぴ + 작은 ゃ + 반탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'ぴゅ', romaji: 'pyu', korean: '퓨', strokes: 'ぴ + 작은 ゅ + 반탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] },
                { char: 'ぴょ', romaji: 'pyo', korean: '표', strokes: 'ぴ + 작은 ょ + 반탁점', 
                  strokeOrder: [[0.32, 0.28, 0.52, 0.32], [0.38, 0.42, 0.65, 0.72]] }
            ]
        };

        let currentCategory = 'basic';
        let currentIndex = 0;
        let isDrawing = false;
        let showGuide = false;

        const canvas = document.getElementById('drawingCanvas');
        const guideCanvas = document.getElementById('guideCanvas');
        const ctx = canvas.getContext('2d');
        const guideCtx = guideCanvas.getContext('2d');

        function initCanvas() {
            const container = canvas.parentElement;
            const rect = container.getBoundingClientRect();
            
            canvas.width = rect.width;
            canvas.height = 300;
            guideCanvas.width = rect.width;
            guideCanvas.height = 300;

            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = '#667eea';

            drawGuideCharacter();
        }

        function drawGuideCharacter() {
            const currentChar = hiraganaData[currentCategory][currentIndex];
            guideCtx.clearRect(0, 0, guideCanvas.width, guideCanvas.height);
            
            // Calculate font size to fill 80% of canvas height
            const fontSize = Math.min(guideCanvas.width, guideCanvas.height) * 0.8;
            guideCtx.font = `bold ${fontSize}px sans-serif`;
            guideCtx.fillStyle = '#764ba2';
            guideCtx.textAlign = 'center';
            guideCtx.textBaseline = 'middle';
            guideCtx.fillText(currentChar.char, guideCanvas.width / 2, guideCanvas.height / 2);
        }

        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches ? e.touches[0] : e;
            return {
                x: touch.clientX - rect.left,
                y: touch.clientY - rect.top
            };
        }

        function startDrawing(e) {
            e.preventDefault();
            isDrawing = true;
            const pos = getPos(e);
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function toggleGuide() {
            showGuide = !showGuide;
            guideCanvas.style.opacity = showGuide ? '0.3' : '0';
        }

        function nextCharacter() {
            const categoryData = hiraganaData[currentCategory];
            currentIndex = (currentIndex + 1) % categoryData.length;
            updateDisplay();
            clearCanvas();
            drawGuideCharacter();
        }

        function selectCategory(category) {
            currentCategory = category;
            currentIndex = 0;
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateDisplay();
            clearCanvas();
            drawGuideCharacter();
        }

        function updateDisplay() {
            const currentChar = hiraganaData[currentCategory][currentIndex];
            document.getElementById('currentCharacter').textContent = currentChar.char;
            document.getElementById('characterInfo').textContent = 
                `${currentChar.romaji} (${currentChar.korean})`;
            document.getElementById('strokeOrder').textContent = 
                `획순: ${currentChar.strokes}`;
            document.getElementById('progressText').textContent = 
                `${currentIndex + 1} / ${hiraganaData[currentCategory].length}`;
        }

        // Event listeners
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', stopDrawing);

        window.addEventListener('resize', initCanvas);
        
        function goBack() {
            window.location.href = 'index.html';
        }
        
        initCanvas();
        updateDisplay();
    </script>
</body>
</html>
