<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÌûàÎùºÍ∞ÄÎÇò Îî∞ÎùºÏì∞Í∏∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
            max-width: 500px;
            width: 100%;
        }

        h1 {
            color: #667eea;
            font-size: 22px;
            flex: 1;
            white-space: nowrap;
        }

        .header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 10px;
        }

        .back-button {
            background: #e9ecef;
            border: none;
            border-radius: 8px;
            width: 36px;
            height: 36px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-button:hover {
            background: #dee2e6;
            transform: translateX(-3px);
        }

        .character-display {
            text-align: center;
            margin-bottom: 20px;
        }

        .current-character {
            font-size: 80px;
            color: #764ba2;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .character-info {
            font-size: 18px;
            color: #666;
        }

        .canvas-container {
            position: relative;
            background: #f8f9fa;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid #e0e0e0;
            overflow: hidden;
        }

        #drawingCanvas {
            display: block;
            width: 100%;
            height: 250px;
            cursor: crosshair;
            touch-action: none;
        }

        .guide-canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            opacity: 0;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            padding: 14px 10px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .btn-clear {
            background: #ff6b6b;
            color: white;
        }

        .btn-clear:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        .btn-next {
            background: #51cf66;
            color: white;
        }

        .btn-next:hover {
            background: #40c057;
            transform: translateY(-2px);
        }

        .btn-prev {
            background: #74c0fc;
            color: white;
        }

        .btn-prev:hover {
            background: #4dabf7;
            transform: translateY(-2px);
        }

        .btn-show-guide {
            background: #ffd43b;
            color: #333;
        }

        .btn-show-guide:hover {
            background: #fcc419;
            transform: translateY(-2px);
        }

        .progress {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .level-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .level-btn {
            padding: 12px 10px;
            background: #e9ecef;
            color: #495057;
            border: 2px solid transparent;
            border-radius: 10px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .level-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .level-btn:hover {
            transform: translateY(-2px);
        }

        .category-selector {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .category-btn {
            padding: 10px 5px;
            background: #e9ecef;
            color: #495057;
            border: 2px solid transparent;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .stroke-order {
            text-align: center;
            margin-top: 10px;
            padding: 12px;
            background: #e7f5ff;
            border-radius: 8px;
            font-size: 14px;
            color: #1864ab;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.5;
        }

        @media (max-width: 400px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 18px;
            }
            
            .current-character {
                font-size: 60px;
            }
            
            .character-info {
                font-size: 16px;
            }
            
            .category-selector {
                grid-template-columns: repeat(5, 1fr);
                gap: 6px;
            }
            
            .category-btn {
                padding: 8px 3px;
                font-size: 14px;
            }
            
            button {
                padding: 12px 8px;
                font-size: 14px;
            }
            
            .stroke-order {
                font-size: 13px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="back-button" onclick="goBack()">‚Üê</button>
            <h1>„ÅÇ ÌûàÎùºÍ∞ÄÎÇò Îî∞ÎùºÏì∞Í∏∞</h1>
        </div>

        <div class="level-selector">
            <button class="level-btn active" onclick="selectTab('basic')">Ï≤≠Ïùå (Í∏∞Î≥∏)</button>
            <button class="level-btn" onclick="selectTab('extended')">ÌÉÅÏùå/Î∞òÌÉÅÏùå</button>
        </div>

        <div class="category-selector" id="categorySelector"></div>

        <div class="progress" id="progressText">1 / 5</div>

        <div class="character-display">
            <div class="current-character" id="currentCharacter">„ÅÇ</div>
            <div class="character-info" id="characterInfo">a (ÏïÑ)</div>
        </div>

        <div class="canvas-container">
            <canvas id="drawingCanvas"></canvas>
            <canvas id="guideCanvas" class="guide-canvas"></canvas>
        </div>

        <div class="controls">
            <button class="btn-prev" onclick="prevCharacter()">‚óÄ Ïù¥Ï†Ñ</button>
            <button class="btn-next" onclick="nextCharacter()">Îã§Ïùå ‚ñ∂</button>
            <button class="btn-clear" onclick="clearCanvas()">üóë ÏßÄÏö∞Í∏∞</button>
            <button class="btn-show-guide" onclick="toggleGuide()">üëÅ Í∞ÄÏù¥Îìú</button>
        </div>

        <div class="stroke-order" id="strokeOrder">ÌöçÏàú: 1Ìöç: ÏôºÏ™Ω ÏúÑ‚ÜíÏò§Î•∏Ï™Ω ÏïÑÎûò Í≥°ÏÑ†</div>
    </div>

    <script>
        const hiraganaData = {
            a: [
                { char: '„ÅÇ', romaji: 'a', korean: 'ÏïÑ', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏÑ∏Î°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„ÅÑ', romaji: 'i', korean: 'Ïù¥', strokes: '2Ìöç: ÏôºÏ™Ω ÏÑ∏Î°ú‚ÜíÏò§Î•∏Ï™Ω ÏÑ∏Î°ú' },
                { char: '„ÅÜ', romaji: 'u', korean: 'Ïö∞', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åà', romaji: 'e', korean: 'Ïóê', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åä', romaji: 'o', korean: 'Ïò§', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏÑ∏Î°ú‚ÜíÏò§Î•∏Ï™Ω Í≥°ÏÑ†' }
            ],
            ka: [
                { char: '„Åã', romaji: 'ka', korean: 'Ïπ¥', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏÑ∏Î°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åå', romaji: 'ga', korean: 'Í∞Ä', strokes: '„Åã + ÌÉÅÏ†ê' },
                { char: '„Åç', romaji: 'ki', korean: 'ÌÇ§', strokes: '4Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í∞ÄÎ°ú‚ÜíÏÑ∏Î°ú' },
                { char: '„Åé', romaji: 'gi', korean: 'Í∏∞', strokes: '„Åç + ÌÉÅÏ†ê' },
                { char: '„Åç„ÇÉ', romaji: 'kya', korean: 'Ï∫¨', strokes: '„Åç + ÏûëÏùÄ „ÇÉ' },
                { char: '„Åç„ÇÖ', romaji: 'kyu', korean: 'ÌÅê', strokes: '„Åç + ÏûëÏùÄ „ÇÖ' },
                { char: '„Åç„Çá', romaji: 'kyo', korean: 'ÏøÑ', strokes: '„Åç + ÏûëÏùÄ „Çá' },
                { char: '„Åé„ÇÉ', romaji: 'gya', korean: 'Í∞∏', strokes: '„Åé + ÏûëÏùÄ „ÇÉ' },
                { char: '„Åé„ÇÖ', romaji: 'gyu', korean: 'Í∑ú', strokes: '„Åé + ÏûëÏùÄ „ÇÖ' },
                { char: '„Åé„Çá', romaji: 'gyo', korean: 'Íµê', strokes: '„Åé + ÏûëÏùÄ „Çá' },
                { char: '„Åè', romaji: 'ku', korean: 'Ïø†', strokes: '1Ìöç: ÏôºÏ™Ω‚ÜíÏò§Î•∏Ï™Ω Í∫æÏûÑ' },
                { char: '„Åê', romaji: 'gu', korean: 'Íµ¨', strokes: '„Åè + ÌÉÅÏ†ê' },
                { char: '„Åë', romaji: 'ke', korean: 'ÏºÄ', strokes: '3Ìöç: ÏôºÏ™Ω ÏÑ∏Î°ú‚ÜíÏúÑ Í∞ÄÎ°ú‚ÜíÏò§Î•∏Ï™Ω ÏÑ∏Î°ú' },
                { char: '„Åí', romaji: 'ge', korean: 'Í≤å', strokes: '„Åë + ÌÉÅÏ†ê' },
                { char: '„Åì', romaji: 'ko', korean: 'ÏΩî', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í∞ÄÎ°ú' },
                { char: '„Åî', romaji: 'go', korean: 'Í≥†', strokes: '„Åì + ÌÉÅÏ†ê' }
            ],
            sa: [
                { char: '„Åï', romaji: 'sa', korean: 'ÏÇ¨', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏÑ∏Î°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åñ', romaji: 'za', korean: 'Ïûê', strokes: '„Åï + ÌÉÅÏ†ê' },
                { char: '„Åó', romaji: 'shi', korean: 'Ïãú', strokes: '1Ìöç: ÏúÑ‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åò', romaji: 'ji', korean: 'ÏßÄ', strokes: '„Åó + ÌÉÅÏ†ê' },
                { char: '„Åó„ÇÉ', romaji: 'sha', korean: 'ÏÉ§', strokes: '„Åó + ÏûëÏùÄ „ÇÉ' },
                { char: '„Åó„ÇÖ', romaji: 'shu', korean: 'Ïäà', strokes: '„Åó + ÏûëÏùÄ „ÇÖ' },
                { char: '„Åó„Çá', romaji: 'sho', korean: 'Ïáº', strokes: '„Åó + ÏûëÏùÄ „Çá' },
                { char: '„Åò„ÇÉ', romaji: 'ja', korean: 'Ïüà', strokes: '„Åò + ÏûëÏùÄ „ÇÉ' },
                { char: '„Åò„ÇÖ', romaji: 'ju', korean: 'Ï•¨', strokes: '„Åò + ÏûëÏùÄ „ÇÖ' },
                { char: '„Åò„Çá', romaji: 'jo', korean: 'Ï£†', strokes: '„Åò + ÏûëÏùÄ „Çá' },
                { char: '„Åô', romaji: 'su', korean: 'Ïä§', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åö', romaji: 'zu', korean: 'Ï¶à', strokes: '„Åô + ÌÉÅÏ†ê' },
                { char: '„Åõ', romaji: 'se', korean: 'ÏÑ∏', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏïÑÎûò ÏÑ∏Î°ú' },
                { char: '„Åú', romaji: 'ze', korean: 'Ï†ú', strokes: '„Åõ + ÌÉÅÏ†ê' },
                { char: '„Åù', romaji: 'so', korean: 'ÏÜå', strokes: '1Ìöç: ÏúÑ‚ÜíÏïÑÎûò ÏßÄÍ∑∏Ïû¨Í∑∏' },
                { char: '„Åû', romaji: 'zo', korean: 'Ï°∞', strokes: '„Åù + ÌÉÅÏ†ê' }
            ],
            ta: [
                { char: '„Åü', romaji: 'ta', korean: 'ÌÉÄ', strokes: '4Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏÑ∏Î°ú‚ÜíÏïÑÎûò Í∞ÄÎ°ú‚ÜíÏ†ê' },
                { char: '„Å†', romaji: 'da', korean: 'Îã§', strokes: '„Åü + ÌÉÅÏ†ê' },
                { char: '„Å°', romaji: 'chi', korean: 'Ïπò', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Å¢', romaji: 'di', korean: 'ÏßÄ', strokes: '„Å° + ÌÉÅÏ†ê' },
                { char: '„Å°„ÇÉ', romaji: 'cha', korean: 'Ï±†', strokes: '„Å° + ÏûëÏùÄ „ÇÉ' },
                { char: '„Å°„ÇÖ', romaji: 'chu', korean: 'Ï∏Ñ', strokes: '„Å° + ÏûëÏùÄ „ÇÖ' },
                { char: '„Å°„Çá', romaji: 'cho', korean: 'Ïµ∏', strokes: '„Å° + ÏûëÏùÄ „Çá' },
                { char: '„Å§', romaji: 'tsu', korean: 'Ï∏†', strokes: '1Ìöç: ÏôºÏ™Ω‚ÜíÏò§Î•∏Ï™Ω Í≥°ÏÑ†' },
                { char: '„Å•', romaji: 'du', korean: 'Ï¶à', strokes: '„Å§ + ÌÉÅÏ†ê' },
                { char: '„Å¶', romaji: 'te', korean: 'ÌÖå', strokes: '1Ìöç: ÏúÑ‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åß', romaji: 'de', korean: 'Îç∞', strokes: '„Å¶ + ÌÉÅÏ†ê' },
                { char: '„Å®', romaji: 'to', korean: 'ÌÜ†', strokes: '2Ìöç: ÏúÑ ÏÑ∏Î°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Å©', romaji: 'do', korean: 'ÎèÑ', strokes: '„Å® + ÌÉÅÏ†ê' }
            ],
            na: [
                { char: '„Å™', romaji: 'na', korean: 'ÎÇò', strokes: '4Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏÑ∏Î°ú‚ÜíÏ†ê‚ÜíÍ≥°ÏÑ†' },
                { char: '„Å´', romaji: 'ni', korean: 'Îãà', strokes: '3Ìöç: ÏôºÏ™Ω ÏÑ∏Î°ú‚ÜíÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í∞ÄÎ°ú' },
                { char: '„Å´„ÇÉ', romaji: 'nya', korean: 'ÎÉê', strokes: '„Å´ + ÏûëÏùÄ „ÇÉ' },
                { char: '„Å´„ÇÖ', romaji: 'nyu', korean: 'Îâ¥', strokes: '„Å´ + ÏûëÏùÄ „ÇÖ' },
                { char: '„Å´„Çá', romaji: 'nyo', korean: 'Îá®', strokes: '„Å´ + ÏûëÏùÄ „Çá' },
                { char: '„Å¨', romaji: 'nu', korean: 'ÎàÑ', strokes: '2Ìöç: ÏôºÏ™Ω Í≥°ÏÑ†‚ÜíÏò§Î•∏Ï™Ω Í≥°ÏÑ†' },
                { char: '„Å≠', romaji: 'ne', korean: 'ÎÑ§', strokes: '2Ìöç: ÏôºÏ™Ω ÏÑ∏Î°ú‚ÜíÏò§Î•∏Ï™Ω Í≥°ÏÑ†' },
                { char: '„ÅÆ', romaji: 'no', korean: 'ÎÖ∏', strokes: '1Ìöç: ÏõêÌòï Í≥°ÏÑ†' }
            ],
            ha: [
                { char: '„ÅØ', romaji: 'ha', korean: 'Ìïò', strokes: '3Ìöç: ÏôºÏ™Ω ÏÑ∏Î°ú‚ÜíÏúÑ Í∞ÄÎ°ú‚ÜíÏò§Î•∏Ï™Ω Í≥°ÏÑ†' },
                { char: '„Å∞', romaji: 'ba', korean: 'Î∞î', strokes: '„ÅØ + ÌÉÅÏ†ê' },
                { char: '„Å±', romaji: 'pa', korean: 'Ìåå', strokes: '„ÅØ + Î∞òÌÉÅÏ†ê' },
                { char: '„Å≤', romaji: 'hi', korean: 'Ìûà', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Å≥', romaji: 'bi', korean: 'ÎπÑ', strokes: '„Å≤ + ÌÉÅÏ†ê' },
                { char: '„Å¥', romaji: 'pi', korean: 'Ìîº', strokes: '„Å≤ + Î∞òÌÉÅÏ†ê' },
                { char: '„Å≤„ÇÉ', romaji: 'hya', korean: 'Ìñê', strokes: '„Å≤ + ÏûëÏùÄ „ÇÉ' },
                { char: '„Å≤„ÇÖ', romaji: 'hyu', korean: 'Ìú¥', strokes: '„Å≤ + ÏûëÏùÄ „ÇÖ' },
                { char: '„Å≤„Çá', romaji: 'hyo', korean: 'Ìö®', strokes: '„Å≤ + ÏûëÏùÄ „Çá' },
                { char: '„Å≥„ÇÉ', romaji: 'bya', korean: 'Î±å', strokes: '„Å≥ + ÏûëÏùÄ „ÇÉ' },
                { char: '„Å≥„ÇÖ', romaji: 'byu', korean: 'Î∑∞', strokes: '„Å≥ + ÏûëÏùÄ „ÇÖ' },
                { char: '„Å≥„Çá', romaji: 'byo', korean: 'Îµ§', strokes: '„Å≥ + ÏûëÏùÄ „Çá' },
                { char: '„Å¥„ÇÉ', romaji: 'pya', korean: 'ÌçÑ', strokes: '„Å¥ + ÏûëÏùÄ „ÇÉ' },
                { char: '„Å¥„ÇÖ', romaji: 'pyu', korean: 'Ìì®', strokes: '„Å¥ + ÏûëÏùÄ „ÇÖ' },
                { char: '„Å¥„Çá', romaji: 'pyo', korean: 'Ìëú', strokes: '„Å¥ + ÏûëÏùÄ „Çá' },
                { char: '„Åµ', romaji: 'fu', korean: 'ÌõÑ', strokes: '4Ìöç: ÏôºÏ™Ω ÏúÑ Ï†ê‚ÜíÏúÑ Í∞ÄÎ°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏïÑÎûò ÏÑ∏Î°ú' },
                { char: '„Å∂', romaji: 'bu', korean: 'Î∂Ä', strokes: '„Åµ + ÌÉÅÏ†ê' },
                { char: '„Å∑', romaji: 'pu', korean: 'Ìë∏', strokes: '„Åµ + Î∞òÌÉÅÏ†ê' },
                { char: '„Å∏', romaji: 'he', korean: 'Ìó§', strokes: '1Ìöç: ÏôºÏ™Ω‚ÜíÏò§Î•∏Ï™Ω ÏÇ¨ÏÑ†' },
                { char: '„Åπ', romaji: 'be', korean: 'Î≤†', strokes: '„Å∏ + ÌÉÅÏ†ê' },
                { char: '„Å∫', romaji: 'pe', korean: 'Ìéò', strokes: '„Å∏ + Î∞òÌÉÅÏ†ê' },
                { char: '„Åª', romaji: 'ho', korean: 'Ìò∏', strokes: '4Ìöç: Îß® ÏúÑ Í∞ÄÎ°ú‚ÜíÏôºÏ™Ω ÏÑ∏Î°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏò§Î•∏Ï™Ω ÏÑ∏Î°ú' },
                { char: '„Åº', romaji: 'bo', korean: 'Î≥¥', strokes: '„Åª + ÌÉÅÏ†ê' },
                { char: '„ÅΩ', romaji: 'po', korean: 'Ìè¨', strokes: '„Åª + Î∞òÌÉÅÏ†ê' }
            ],
            ma: [
                { char: '„Åæ', romaji: 'ma', korean: 'Îßà', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏÑ∏Î°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åø', romaji: 'mi', korean: 'ÎØ∏', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Åø„ÇÉ', romaji: 'mya', korean: 'Î®Ä', strokes: '„Åø + ÏûëÏùÄ „ÇÉ' },
                { char: '„Åø„ÇÖ', romaji: 'myu', korean: 'ÎÆ§', strokes: '„Åø + ÏûëÏùÄ „ÇÖ' },
                { char: '„Åø„Çá', romaji: 'myo', korean: 'Î¨ò', strokes: '„Åø + ÏûëÏùÄ „Çá' },
                { char: '„ÇÄ', romaji: 'mu', korean: 'Î¨¥', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏïÑÎûò ÏÑ∏Î°ú' },
                { char: '„ÇÅ', romaji: 'me', korean: 'Î©î', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„ÇÇ', romaji: 'mo', korean: 'Î™®', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏïÑÎûò ÏÑ∏Î°ú' }
            ],
            ya: [
                { char: '„ÇÑ', romaji: 'ya', korean: 'Ïïº', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„ÇÜ', romaji: 'yu', korean: 'Ïú†', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Çà', romaji: 'yo', korean: 'Ïöî', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' }
            ],
            ra: [
                { char: '„Çâ', romaji: 'ra', korean: 'Îùº', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Çä', romaji: 'ri', korean: 'Î¶¨', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Çä„ÇÉ', romaji: 'rya', korean: 'Îû¥', strokes: '„Çä + ÏûëÏùÄ „ÇÉ' },
                { char: '„Çä„ÇÖ', romaji: 'ryu', korean: 'Î•ò', strokes: '„Çä + ÏûëÏùÄ „ÇÖ' },
                { char: '„Çä„Çá', romaji: 'ryo', korean: 'Î£å', strokes: '„Çä + ÏûëÏùÄ „Çá' },
                { char: '„Çã', romaji: 'ru', korean: 'Î£®', strokes: '1Ìöç: ÏúÑ‚ÜíÏïÑÎûò ÎÇòÏÑ†Ìòï Í≥°ÏÑ†' },
                { char: '„Çå', romaji: 're', korean: 'Î†à', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Çç', romaji: 'ro', korean: 'Î°ú', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏïÑÎûò ÏÑ∏Î°ú' }
            ],
            wa: [
                { char: '„Çè', romaji: 'wa', korean: 'ÏôÄ', strokes: '2Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Çí', romaji: 'wo/o', korean: 'Ïò§(Ï°∞ÏÇ¨)', strokes: '3Ìöç: ÏúÑ Í∞ÄÎ°ú‚ÜíÏ§ëÍ∞Ñ Í∞ÄÎ°ú‚ÜíÏïÑÎûò Í≥°ÏÑ†' },
                { char: '„Çì', romaji: 'n', korean: 'Ïùë', strokes: '1Ìöç: ÏôºÏ™Ω‚ÜíÏò§Î•∏Ï™Ω Í≥°ÏÑ†' }
            ]
        };

        // Ï≤≠ÏùåÎßå ÌëúÏãú
        const basicCategories = ['a', 'ka', 'sa', 'ta', 'na', 'ha', 'ma', 'ya', 'ra', 'wa'];
        // ÌÉÅÏùå/Î∞òÌÉÅÏùå/ÏöîÏùåÏù¥ ÏûàÎäî Í≤ÉÎì§Îßå
        const extendedCategories = ['ka', 'sa', 'ta', 'na', 'ha', 'ma', 'ra'];

        const categoryLabels = {
            a: '„ÅÇ',
            ka: '„Åã',
            sa: '„Åï',
            ta: '„Åü',
            na: '„Å™',
            ha: '„ÅØ',
            ma: '„Åæ',
            ya: '„ÇÑ',
            ra: '„Çâ',
            wa: '„Çè'
        };

        let currentTab = 'basic';
        let currentCategory = 'a';
        let currentIndex = 0;
        let isDrawing = false;
        let showGuide = false;

        const canvas = document.getElementById('drawingCanvas');
        const guideCanvas = document.getElementById('guideCanvas');
        const ctx = canvas.getContext('2d');
        const guideCtx = guideCanvas.getContext('2d');

        function initCanvas() {
            const container = canvas.parentElement;
            const rect = container.getBoundingClientRect();
            
            canvas.width = rect.width;
            canvas.height = 250;
            guideCanvas.width = rect.width;
            guideCanvas.height = 250;

            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = '#667eea';

            drawGuideCharacter();
        }

        function drawGuideCharacter() {
            const currentChar = hiraganaData[currentCategory][currentIndex];
            guideCtx.clearRect(0, 0, guideCanvas.width, guideCanvas.height);
            
            // Í∏ÄÏûê ÏàòÏóê Îî∞Îùº Ìè∞Ìä∏ ÌÅ¨Í∏∞ Ï°∞Ï†à
            const charLength = currentChar.char.length;
            let fontSize;
            
            if (charLength === 1) {
                // Îã®Ïùº Í∏ÄÏûê: Ï∫îÎ≤ÑÏä§Ïùò 80%
                fontSize = Math.min(guideCanvas.width, guideCanvas.height) * 0.8;
            } else {
                // 2Í∏ÄÏûê Ïù¥ÏÉÅ: Ï∫îÎ≤ÑÏä§ ÎÑàÎπÑÏóê ÎßûÍ≤å Ï°∞Ï†à
                const testFontSize = 100;
                guideCtx.font = `bold ${testFontSize}px sans-serif`;
                const textWidth = guideCtx.measureText(currentChar.char).width;
                const targetWidth = guideCanvas.width * 0.85;
                fontSize = testFontSize * (targetWidth / textWidth);
                
                // ÎÜíÏù¥ÎèÑ Í≥†Î†§Ìï¥ÏÑú ÏµúÎåÄÍ∞í Ï†úÌïú
                const maxFontSize = guideCanvas.height * 0.7;
                fontSize = Math.min(fontSize, maxFontSize);
            }
            
            guideCtx.font = `bold ${fontSize}px sans-serif`;
            guideCtx.fillStyle = '#764ba2';
            guideCtx.textAlign = 'center';
            guideCtx.textBaseline = 'middle';
            guideCtx.fillText(currentChar.char, guideCanvas.width / 2, guideCanvas.height / 2);
        }

        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches ? e.touches[0] : e;
            return {
                x: touch.clientX - rect.left,
                y: touch.clientY - rect.top
            };
        }

        function startDrawing(e) {
            e.preventDefault();
            isDrawing = true;
            const pos = getPos(e);
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function toggleGuide() {
            showGuide = !showGuide;
            guideCanvas.style.opacity = showGuide ? '0.3' : '0';
        }

        function nextCharacter() {
            const categoryData = hiraganaData[currentCategory];
            currentIndex = (currentIndex + 1) % categoryData.length;
            updateDisplay();
            clearCanvas();
            drawGuideCharacter();
        }

        function prevCharacter() {
            const categoryData = hiraganaData[currentCategory];
            currentIndex = (currentIndex - 1 + categoryData.length) % categoryData.length;
            updateDisplay();
            clearCanvas();
            drawGuideCharacter();
        }

        function selectCategory(category) {
            currentCategory = category;
            currentIndex = 0;
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateDisplay();
            clearCanvas();
            drawGuideCharacter();
        }

        function selectTab(tab) {
            currentTab = tab;
            
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateCategoryButtons();
            
            const categories = currentTab === 'basic' ? basicCategories : extendedCategories;
            currentCategory = categories[0];
            currentIndex = 0;
            updateDisplay();
            clearCanvas();
            drawGuideCharacter();
        }

        function updateCategoryButtons() {
            const categorySelector = document.getElementById('categorySelector');
            const categories = currentTab === 'basic' ? basicCategories : extendedCategories;
            
            categorySelector.innerHTML = '';
            categories.forEach((cat, index) => {
                const button = document.createElement('button');
                button.className = 'category-btn' + (index === 0 ? ' active' : '');
                button.textContent = categoryLabels[cat];
                button.onclick = () => selectCategory(cat);
                categorySelector.appendChild(button);
            });
        }

        function updateDisplay() {
            const currentChar = hiraganaData[currentCategory][currentIndex];
            document.getElementById('currentCharacter').textContent = currentChar.char;
            document.getElementById('characterInfo').textContent = 
                `${currentChar.romaji} (${currentChar.korean})`;
            document.getElementById('strokeOrder').textContent = 
                `ÌöçÏàú: ${currentChar.strokes}`;
            document.getElementById('progressText').textContent = 
                `${currentIndex + 1} / ${hiraganaData[currentCategory].length}`;
        }

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', stopDrawing);

        window.addEventListener('resize', initCanvas);
        
        function goBack() {
            window.location.href = 'index.html';
        }
        
        // Ï¥àÍ∏∞Ìôî
        updateCategoryButtons();
        initCanvas();
        updateDisplay();
    </script>
</body>
</html>
