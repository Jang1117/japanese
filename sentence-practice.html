<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¼ë³¸ì–´ ë¬¸ì¥ ì—°ìŠµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
            max-width: 600px;
            width: 100%;
        }

        .header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .back-button {
            background: #e9ecef;
            border: none;
            border-radius: 10px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 18px;
            margin-right: 15px;
            transition: all 0.3s;
        }

        .back-button:hover {
            background: #dee2e6;
            transform: translateX(-3px);
        }

        h1 {
            color: #4facfe;
            font-size: 28px;
            flex: 1;
        }

        .level-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .level-btn {
            flex: 1;
            min-width: 100px;
            padding: 10px;
            background: #e9ecef;
            color: #495057;
            border: 2px solid transparent;
            border-radius: 10px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .level-btn.active {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }

        .level-btn:hover {
            transform: translateY(-2px);
        }

        .progress {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .sentence-display {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .japanese-sentence {
            font-size: 32px;
            color: #212529;
            margin-bottom: 15px;
            text-align: center;
            line-height: 1.5;
        }

        .romaji {
            font-size: 16px;
            color: #6c757d;
            margin-bottom: 10px;
            text-align: center;
        }

        .korean-translation {
            font-size: 18px;
            color: #495057;
            text-align: center;
            font-weight: 500;
        }

        .canvas-container {
            position: relative;
            background: #ffffff;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid #e0e0e0;
            overflow: hidden;
        }

        #drawingCanvas {
            display: block;
            width: 100%;
            height: 250px;
            cursor: crosshair;
            touch-action: none;
        }

        .guide-canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            opacity: 0;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-clear {
            background: #ff6b6b;
            color: white;
        }

        .btn-clear:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        .btn-guide {
            background: #ffd43b;
            color: #333;
        }

        .btn-guide:hover {
            background: #fcc419;
            transform: translateY(-2px);
        }

        .btn-next {
            background: #51cf66;
            color: white;
        }

        .btn-next:hover {
            background: #40c057;
            transform: translateY(-2px);
        }

        .hint-section {
            background: #e7f5ff;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .hint-title {
            font-size: 14px;
            color: #1864ab;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .hint-content {
            font-size: 13px;
            color: #495057;
            line-height: 1.6;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 22px;
            }
            
            .japanese-sentence {
                font-size: 26px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="back-button" onclick="goBack()">â†</button>
            <h1>ğŸ“ ì¼ë³¸ì–´ ë¬¸ì¥ ì—°ìŠµ</h1>
        </div>

        <div class="level-selector">
            <button class="level-btn active" onclick="selectLevel('beginner')">ì´ˆê¸‰</button>
            <button class="level-btn" onclick="selectLevel('basic')">ê¸°ì´ˆ</button>
            <button class="level-btn" onclick="selectLevel('intermediate')">ì¤‘ê¸‰</button>
        </div>

        <div class="progress">
            <span id="progressText">1 / 5</span>
        </div>

        <div class="sentence-display">
            <div class="japanese-sentence" id="japaneseSentence">ã“ã‚“ã«ã¡ã¯</div>
            <div class="romaji" id="romajiText">konnichiwa</div>
            <div class="korean-translation" id="koreanTranslation">ì•ˆë…•í•˜ì„¸ìš”</div>
        </div>

        <div class="canvas-container">
            <canvas id="guideCanvas" class="guide-canvas"></canvas>
            <canvas id="drawingCanvas"></canvas>
        </div>

        <div class="controls">
            <button class="btn-clear" onclick="clearCanvas()">ì§€ìš°ê¸°</button>
            <button class="btn-guide" onclick="toggleGuide()">ê°€ì´ë“œ</button>
            <button class="btn-next" onclick="nextSentence()">ë‹¤ìŒ</button>
        </div>

        <div class="hint-section">
            <div class="hint-title">ğŸ’¡ í•™ìŠµ íŒ</div>
            <div class="hint-content" id="hintContent">
                ê°„ë‹¨í•œ ì¸ì‚¬ë§ë¶€í„° ì‹œì‘í•´ë³´ì„¸ìš”. ì²œì²œíˆ ë”°ë¼ ì“°ë©´ì„œ ê° ê¸€ìì˜ ëª¨ì–‘ì„ ìµí˜€ë³´ì„¸ìš”.
            </div>
        </div>
    </div>

    <script>
        const sentences = {
            beginner: [
                {
                    japanese: 'ã“ã‚“ã«ã¡ã¯',
                    romaji: 'konnichiwa',
                    korean: 'ì•ˆë…•í•˜ì„¸ìš”',
                    hint: 'ê°€ì¥ ê¸°ë³¸ì ì¸ ì¸ì‚¬ë§ì…ë‹ˆë‹¤. ë‚® ì‹œê°„ëŒ€ì— ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã‚ŠãŒã¨ã†',
                    romaji: 'arigatou',
                    korean: 'ê³ ë§ˆì›Œìš”',
                    hint: 'ê°ì‚¬ë¥¼ í‘œí˜„í•˜ëŠ” ê¸°ë³¸ í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã¯ã‚ˆã†',
                    romaji: 'ohayou',
                    korean: 'ì¢‹ì€ ì•„ì¹¨',
                    hint: 'ì•„ì¹¨ ì¸ì‚¬ì…ë‹ˆë‹¤. ì¹œí•œ ì‚¬ì´ì— ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã“ã‚“ã°ã‚“ã¯',
                    romaji: 'konbanwa',
                    korean: 'ì•ˆë…•í•˜ì„¸ìš” (ì €ë…)',
                    hint: 'ì €ë… ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã•ã‚ˆã†ãªã‚‰',
                    romaji: 'sayounara',
                    korean: 'ì•ˆë…•íˆ ê°€ì„¸ìš”',
                    hint: 'ì‘ë³„ ì¸ì‚¬ì…ë‹ˆë‹¤. ì˜¤ëœ ì‹œê°„ ë§Œë‚˜ì§€ ì•Šì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã‚„ã™ã¿',
                    romaji: 'oyasumi',
                    korean: 'ì˜ ì',
                    hint: 'ì ë“¤ê¸° ì „ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã”ã‚ã‚“ãªã•ã„',
                    romaji: 'gomennasai',
                    korean: 'ë¯¸ì•ˆí•´ìš”',
                    hint: 'ì‚¬ê³¼í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¯ã„',
                    romaji: 'hai',
                    korean: 'ë„¤',
                    hint: 'ê¸ì •ì˜ ëŒ€ë‹µì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã„ã„ãˆ',
                    romaji: 'iie',
                    korean: 'ì•„ë‹ˆìš”',
                    hint: 'ë¶€ì •ì˜ ëŒ€ë‹µì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã‹ã‚Šã¾ã—ãŸ',
                    romaji: 'wakarimashita',
                    korean: 'ì•Œê² ìŠµë‹ˆë‹¤',
                    hint: 'ì´í•´í–ˆìŒì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã©ã†ã„ãŸã—ã¾ã—ã¦',
                    romaji: 'douitashimashite',
                    korean: 'ì²œë§Œì—ìš”',
                    hint: 'ê°ì‚¬ì— ëŒ€í•œ ì‘ë‹µì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã˜ã‚ƒã‚ã­',
                    romaji: 'jaane',
                    korean: 'ê·¸ëŸ¼ ì•ˆë…•',
                    hint: 'ì¹œêµ¬ì™€ í—¤ì–´ì§ˆ ë•Œ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                }
            ],
            basic: [
                {
                    japanese: 'ã‚ãŸã—ã¯ ãŒãã›ã„ ã§ã™',
                    romaji: 'watashi wa gakusei desu',
                    korean: 'ì €ëŠ” í•™ìƒì…ë‹ˆë‹¤',
                    hint: 'ìê¸°ì†Œê°œì˜ ê¸°ë³¸ ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã“ã‚Œã¯ ã»ã‚“ ã§ã™',
                    romaji: 'kore wa hon desu',
                    korean: 'ì´ê²ƒì€ ì±…ì…ë‹ˆë‹¤',
                    hint: 'ì‚¬ë¬¼ì„ ê°€ë¦¬í‚¬ ë•Œ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãªã¾ãˆã¯ ãªã‚“ ã§ã™ã‹',
                    romaji: 'namae wa nan desuka',
                    korean: 'ì´ë¦„ì´ ë¬´ì—‡ì…ë‹ˆê¹Œ?',
                    hint: 'ìƒëŒ€ë°©ì˜ ì´ë¦„ì„ ë¬¼ì–´ë³´ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã™ã¿ã¾ã›ã‚“',
                    romaji: 'sumimasen',
                    korean: 'ì£„ì†¡í•©ë‹ˆë‹¤ / ì‹¤ë¡€í•©ë‹ˆë‹¤',
                    hint: 'ì‚¬ê³¼í•˜ê±°ë‚˜ ì£¼ì˜ë¥¼ ëŒ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã„ãŸã ãã¾ã™',
                    romaji: 'itadakimasu',
                    korean: 'ì˜ ë¨¹ê² ìŠµë‹ˆë‹¤',
                    hint: 'ì‹ì‚¬ ì „ì— í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã”ã¡ãã†ã•ã¾ã§ã—ãŸ',
                    romaji: 'gochisousamadeshita',
                    korean: 'ì˜ ë¨¹ì—ˆìŠµë‹ˆë‹¤',
                    hint: 'ì‹ì‚¬ í›„ì— í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ãŸã—ã¯ ã«ã»ã‚“ã˜ã‚“ ã§ã™',
                    romaji: 'watashi wa nihonjin desu',
                    korean: 'ì €ëŠ” ì¼ë³¸ì¸ì…ë‹ˆë‹¤',
                    hint: 'êµ­ì ì„ ë§í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã“ã‚Œã¯ ã„ãã‚‰ ã§ã™ã‹',
                    romaji: 'kore wa ikura desuka',
                    korean: 'ì´ê²ƒì€ ì–¼ë§ˆì…ë‹ˆê¹Œ?',
                    hint: 'ê°€ê²©ì„ ë¬¼ì–´ë³¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã™ãã§ã™',
                    romaji: 'suki desu',
                    korean: 'ì¢‹ì•„í•©ë‹ˆë‹¤',
                    hint: 'ì¢‹ì•„í•˜ëŠ” ê²ƒì„ í‘œí˜„í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã‹ã‚Šã¾ã›ã‚“',
                    romaji: 'wakarimasen',
                    korean: 'ëª¨ë¥´ê² ìŠµë‹ˆë‹¤',
                    hint: 'ì´í•´í•˜ì§€ ëª»í–ˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã«ã»ã‚“ã”ãŒ ã¯ãªã›ã¾ã™',
                    romaji: 'nihongo ga hanasemasu',
                    korean: 'ì¼ë³¸ì–´ë¥¼ ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                    hint: 'ëŠ¥ë ¥ì„ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãƒˆã‚¤ãƒ¬ã¯ ã©ã“ ã§ã™ã‹',
                    romaji: 'toire wa doko desuka',
                    korean: 'í™”ì¥ì‹¤ì€ ì–´ë””ì…ë‹ˆê¹Œ?',
                    hint: 'í™”ì¥ì‹¤ ìœ„ì¹˜ë¥¼ ë¬¼ì–´ë³¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‹ã‚“ã“ãã˜ã‚“ ã§ã™',
                    romaji: 'kankokujin desu',
                    korean: 'í•œêµ­ì¸ì…ë‹ˆë‹¤',
                    hint: 'êµ­ì ì„ ë§í•˜ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã“ã‚Œã‚’ ãã ã•ã„',
                    romaji: 'kore wo kudasai',
                    korean: 'ì´ê²ƒì„ ì£¼ì„¸ìš”',
                    hint: 'ë¬¼ê±´ì„ ìš”ì²­í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã„ã—ã„ ã§ã™',
                    romaji: 'oishii desu',
                    korean: 'ë§›ìˆìŠµë‹ˆë‹¤',
                    hint: 'ìŒì‹ì´ ë§›ìˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                }
            ],
            intermediate: [
                {
                    japanese: 'ãã‚‡ã†ã¯ ã„ã„ ã¦ã‚“ã ã§ã™ã­',
                    romaji: 'kyou wa ii tenki desune',
                    korean: 'ì˜¤ëŠ˜ì€ ì¢‹ì€ ë‚ ì”¨ë„¤ìš”',
                    hint: 'ë‚ ì”¨ì— ëŒ€í•´ ì´ì•¼ê¸°í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã«ã»ã‚“ã”ã‚’ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™',
                    romaji: 'nihongo wo benkyou shite imasu',
                    korean: 'ì¼ë³¸ì–´ë¥¼ ê³µë¶€í•˜ê³  ìˆìŠµë‹ˆë‹¤',
                    hint: 'í˜„ì¬ ì§„í–‰ ì¤‘ì¸ í–‰ë™ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãˆãã¯ ã©ã“ ã§ã™ã‹',
                    romaji: 'eki wa doko desuka',
                    korean: 'ì—­ì€ ì–´ë””ì…ë‹ˆê¹Œ?',
                    hint: 'ì¥ì†Œë¥¼ ë¬¼ì–´ë³¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠãªã‹ãŒ ã™ãã¾ã—ãŸ',
                    romaji: 'onaka ga sukimashita',
                    korean: 'ë°°ê°€ ê³ íŒŒìš”',
                    hint: 'ë°°ê³ í””ì„ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¾ãŸ ã‚ã—ãŸ',
                    romaji: 'mata ashita',
                    korean: 'ë˜ ë‚´ì¼ ë´ìš”',
                    hint: 'ì¹œê·¼í•œ ì‘ë³„ ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŸã®ã—ã‹ã£ãŸ ã§ã™',
                    romaji: 'tanoshikatta desu',
                    korean: 'ì¦ê±°ì› ìŠµë‹ˆë‹¤',
                    hint: 'ê³¼ê±°ì˜ ì¦ê±°ì› ë˜ ê²½í—˜ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¦ã¤ã ã£ã¦ ãã ã•ã„',
                    romaji: 'tetsudatte kudasai',
                    korean: 'ë„ì™€ì£¼ì„¸ìš”',
                    hint: 'ë„ì›€ì„ ìš”ì²­í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚†ã£ãã‚Š ã¯ãªã—ã¦ ãã ã•ã„',
                    romaji: 'yukkuri hanashite kudasai',
                    korean: 'ì²œì²œíˆ ë§í•´ ì£¼ì„¸ìš”',
                    hint: 'ì²œì²œíˆ ë§í•´ë‹¬ë¼ê³  ë¶€íƒí•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã«ã»ã‚“ã« ã„ããŸã„ ã§ã™',
                    romaji: 'nihon ni ikitai desu',
                    korean: 'ì¼ë³¸ì— ê°€ê³  ì‹¶ìŠµë‹ˆë‹¤',
                    hint: 'í¬ë§ì„ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãˆã„ãŒã‚’ ã¿ã« ã„ãã¾ã™',
                    romaji: 'eiga wo mi ni ikimasu',
                    korean: 'ì˜í™”ë¥¼ ë³´ëŸ¬ ê°‘ë‹ˆë‹¤',
                    hint: 'ëª©ì ì„ ê°€ì§„ ì´ë™ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã—ã‚…ã†ã¾ã¤ã¯ ãªã«ã‚’ ã—ã¾ã™ã‹',
                    romaji: 'shuumatsu wa nani wo shimasuka',
                    korean: 'ì£¼ë§ì— ë¬´ì—‡ì„ í•©ë‹ˆê¹Œ?',
                    hint: 'ê³„íšì„ ë¬¼ì–´ë³´ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¨ã¦ã‚‚ ãã‚Œã„ ã§ã™',
                    romaji: 'totemo kirei desu',
                    korean: 'ë§¤ìš° ì˜ˆì©ë‹ˆë‹¤',
                    hint: 'ì•„ë¦„ë‹¤ì›€ì„ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã—ãŸã¯ ã‚„ã™ã¿ ã§ã™',
                    romaji: 'ashita wa yasumi desu',
                    korean: 'ë‚´ì¼ì€ ì‰¬ëŠ” ë‚ ì…ë‹ˆë‹¤',
                    hint: 'íœ´ì¼ì„ ë§í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚‚ã† ã„ã¡ã© ã„ã£ã¦ ãã ã•ã„',
                    romaji: 'mou ichido itte kudasai',
                    korean: 'í•œ ë²ˆ ë” ë§í•´ ì£¼ì„¸ìš”',
                    hint: 'ë‹¤ì‹œ ë§í•´ë‹¬ë¼ê³  ë¶€íƒí•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã§ã‚“ã‚ã°ã‚“ã”ã†ã‚’ ãŠã—ãˆã¦ ãã ã•ã„',
                    romaji: 'denwabangou wo oshiete kudasai',
                    korean: 'ì „í™”ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”',
                    hint: 'ì—°ë½ì²˜ë¥¼ ë¬¼ì–´ë³¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                }
            ]
        };

        let currentLevel = 'beginner';
        let currentIndex = 0;
        let isDrawing = false;
        let showGuide = false;

        const canvas = document.getElementById('drawingCanvas');
        const guideCanvas = document.getElementById('guideCanvas');
        const ctx = canvas.getContext('2d');
        const guideCtx = guideCanvas.getContext('2d');

        function initCanvas() {
            const container = canvas.parentElement;
            const rect = container.getBoundingClientRect();
            
            canvas.width = rect.width;
            canvas.height = 250;
            guideCanvas.width = rect.width;
            guideCanvas.height = 250;

            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = '#4facfe';

            drawGuideSentence();
        }

        function drawGuideSentence() {
            const sentence = sentences[currentLevel][currentIndex];
            guideCtx.clearRect(0, 0, guideCanvas.width, guideCanvas.height);
            
            // Start with a large font size and measure
            let fontSize = 100;
            guideCtx.font = `bold ${fontSize}px sans-serif`;
            let textWidth = guideCtx.measureText(sentence.japanese).width;
            
            // Adjust font size to fit 90% of canvas width
            const targetWidth = guideCanvas.width * 0.9;
            fontSize = fontSize * (targetWidth / textWidth);
            
            // Limit maximum font size to 80% of canvas height
            const maxFontSize = guideCanvas.height * 0.8;
            fontSize = Math.min(fontSize, maxFontSize);
            
            guideCtx.font = `bold ${fontSize}px sans-serif`;
            guideCtx.fillStyle = '#00f2fe';
            guideCtx.textAlign = 'center';
            guideCtx.textBaseline = 'middle';
            guideCtx.fillText(sentence.japanese, guideCanvas.width / 2, guideCanvas.height / 2);
        }

        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches ? e.touches[0] : e;
            return {
                x: touch.clientX - rect.left,
                y: touch.clientY - rect.top
            };
        }

        function startDrawing(e) {
            e.preventDefault();
            isDrawing = true;
            const pos = getPos(e);
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function toggleGuide() {
            showGuide = !showGuide;
            guideCanvas.style.opacity = showGuide ? '0.3' : '0';
        }

        function nextSentence() {
            const levelData = sentences[currentLevel];
            currentIndex = (currentIndex + 1) % levelData.length;
            updateDisplay();
            clearCanvas();
            drawGuideSentence();
        }

        function selectLevel(level) {
            currentLevel = level;
            currentIndex = 0;
            
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateDisplay();
            clearCanvas();
            drawGuideSentence();
        }

        function updateDisplay() {
            const sentence = sentences[currentLevel][currentIndex];
            document.getElementById('japaneseSentence').textContent = sentence.japanese;
            document.getElementById('romajiText').textContent = sentence.romaji;
            document.getElementById('koreanTranslation').textContent = sentence.korean;
            document.getElementById('hintContent').textContent = sentence.hint;
            document.getElementById('progressText').textContent = 
                `${currentIndex + 1} / ${sentences[currentLevel].length}`;
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        // Event listeners
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', stopDrawing);

        window.addEventListener('resize', initCanvas);
        
        initCanvas();
        updateDisplay();
    </script>
</body>
</html>
