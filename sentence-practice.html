<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¼ë³¸ì–´ ë¬¸ì¥ ì—°ìŠµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
            max-width: 600px;
            width: 100%;
        }

        .header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 10px;
        }

        .back-button {
            background: #e9ecef;
            border: none;
            border-radius: 8px;
            width: 36px;
            height: 36px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-button:hover {
            background: #dee2e6;
            transform: translateX(-3px);
        }

        h1 {
            color: #4facfe;
            font-size: 22px;
            flex: 1;
            white-space: nowrap;
        }

        .level-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .level-btn {
            padding: 12px 10px;
            background: #e9ecef;
            color: #495057;
            border: 2px solid transparent;
            border-radius: 10px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .level-btn.active {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }

        .level-btn:hover {
            transform: translateY(-2px);
        }

        .progress {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .sentence-display {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .japanese-sentence {
            font-size: 28px;
            color: #212529;
            margin-bottom: 12px;
            text-align: center;
            line-height: 1.4;
            word-break: keep-all;
            height: 2.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .romaji {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 8px;
            text-align: center;
        }

        .korean-pronunciation {
            font-size: 15px;
            color: #495057;
            margin-bottom: 8px;
            text-align: center;
            font-weight: 500;
        }

        .korean-translation {
            font-size: 16px;
            color: #0066cc;
            text-align: center;
            font-weight: 600;
        }

        .canvas-container {
            position: relative;
            background: #ffffff;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid #e0e0e0;
            overflow: hidden;
        }

        #drawingCanvas {
            display: block;
            width: 100%;
            height: 250px;
            cursor: crosshair;
            touch-action: none;
        }

        .guide-canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            opacity: 0;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            padding: 14px 10px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .btn-clear {
            background: #ff6b6b;
            color: white;
        }

        .btn-clear:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        .btn-guide {
            background: #ffd43b;
            color: #333;
        }

        .btn-guide:hover {
            background: #fcc419;
            transform: translateY(-2px);
        }

        .btn-prev {
            background: #74c0fc;
            color: white;
        }

        .btn-prev:hover {
            background: #4dabf7;
            transform: translateY(-2px);
        }

        .btn-next {
            background: #51cf66;
            color: white;
        }

        .btn-next:hover {
            background: #40c057;
            transform: translateY(-2px);
        }

        .hint-section {
            background: #e7f5ff;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .hint-title {
            font-size: 14px;
            color: #1864ab;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .hint-content {
            font-size: 13px;
            color: #495057;
            line-height: 1.6;
        }

        @media (max-width: 400px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 18px;
            }
            
            .japanese-sentence {
                font-size: 22px;
            }
            
            .romaji {
                font-size: 13px;
            }
            
            .korean-pronunciation {
                font-size: 14px;
            }
            
            .korean-translation {
                font-size: 15px;
            }
            
            button {
                padding: 12px 8px;
                font-size: 14px;
            }
            
            .sentence-display {
                padding: 15px;
            }
            
            .hint-section {
                padding: 12px;
            }
            
            .hint-title {
                font-size: 13px;
            }
            
            .hint-content {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="back-button" onclick="goBack()">â†</button>
            <h1>ğŸ“ ì¼ë³¸ì–´ ë¬¸ì¥ ì—°ìŠµ</h1>
        </div>

        <div class="level-selector">
            <button class="level-btn active" onclick="selectLevel('beginner')">ì…ë¬¸</button>
            <button class="level-btn" onclick="selectLevel('basic')">ì´ˆê¸‰</button>
            <button class="level-btn" onclick="selectLevel('intermediate')">ì¤‘ê¸‰</button>
        </div>

        <div class="progress" id="progressText">1 / 15</div>

        <div class="sentence-display">
            <div class="japanese-sentence" id="japaneseSentence">ã“ã‚“ã«ã¡ã¯</div>
            <div class="romaji" id="romajiText">konnichiwa</div>
            <div class="korean-pronunciation" id="koreanPronunciation">ì½˜ë‹ˆì¹˜ì™€</div>
            <div class="korean-translation" id="koreanTranslation">ì•ˆë…•í•˜ì„¸ìš”</div>
        </div>

        <div class="canvas-container">
            <canvas id="drawingCanvas"></canvas>
            <canvas id="guideCanvas" class="guide-canvas"></canvas>
        </div>

        <div class="controls">
            <button class="btn-prev" onclick="prevSentence()">â—€ ì´ì „</button>
            <button class="btn-next" onclick="nextSentence()">ë‹¤ìŒ â–¶</button>
            <button class="btn-clear" onclick="clearCanvas()">ğŸ—‘ ì§€ìš°ê¸°</button>
            <button class="btn-guide" onclick="toggleGuide()">ğŸ‘ ê°€ì´ë“œ</button>
        </div>

        <div class="hint-section">
            <div class="hint-title">ğŸ’¡ í•™ìŠµ íŒíŠ¸</div>
            <div class="hint-content" id="hintContent">ì¼ë³¸ì–´ ì¸ì‚¬ ì¤‘ ê°€ì¥ ê¸°ë³¸ì ì¸ í‘œí˜„ì…ë‹ˆë‹¤.</div>
        </div>
    </div>

    <script>
        const sentences = {
            beginner: [
                {
                    japanese: 'ã“ã‚“ã«ã¡ã¯',
                    romaji: 'konnichiwa',
                    pronunciation: 'ê³¤ë‹ˆì¹˜ì™€',
                    korean: 'ì•ˆë…•í•˜ì„¸ìš”',
                    hint: 'ê°€ì¥ ê¸°ë³¸ì ì¸ ì¸ì‚¬ë§ì…ë‹ˆë‹¤. ë‚® ì‹œê°„ëŒ€ì— ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã‚ŠãŒã¨ã†',
                    romaji: 'arigatou',
                    pronunciation: 'ì•„ë¦¬ê°€ë˜',
                    korean: 'ê³ ë§ˆì›Œìš”',
                    hint: 'ê°ì‚¬ë¥¼ í‘œí˜„í•˜ëŠ” ê¸°ë³¸ í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã¯ã‚ˆã†',
                    romaji: 'ohayou',
                    pronunciation: 'ì˜¤í•˜ìš”',
                    korean: 'ì¢‹ì€ ì•„ì¹¨',
                    hint: 'ì•„ì¹¨ ì¸ì‚¬ì…ë‹ˆë‹¤. ì¹œí•œ ì‚¬ì´ì— ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã“ã‚“ã°ã‚“ã¯',
                    romaji: 'konbanwa',
                    pronunciation: 'ê³¤ë°©ì™€',
                    korean: 'ì•ˆë…•í•˜ì„¸ìš” (ì €ë…)',
                    hint: 'ì €ë… ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã•ã‚ˆã†ãªã‚‰',
                    romaji: 'sayounara',
                    pronunciation: 'ì‚¬ìš”ë‚˜ë¼',
                    korean: 'ì•ˆë…•íˆ ê°€ì„¸ìš”',
                    hint: 'ì‘ë³„ ì¸ì‚¬ì…ë‹ˆë‹¤. ì˜¤ëœ ì‹œê°„ ë§Œë‚˜ì§€ ì•Šì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã‚„ã™ã¿',
                    romaji: 'oyasumi',
                    pronunciation: 'ì˜¤ì•¼ìŠ¤ë¯¸',
                    korean: 'ì˜ ì',
                    hint: 'ì ë“¤ê¸° ì „ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã”ã‚ã‚“ãªã•ã„',
                    romaji: 'gomennasai',
                    pronunciation: 'ê³ ë©˜ë‚˜ì‚¬ì´',
                    korean: 'ë¯¸ì•ˆí•´ìš”',
                    hint: 'ì‚¬ê³¼í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¯ã„',
                    romaji: 'hai',
                    pronunciation: 'í•˜ì´',
                    korean: 'ë„¤',
                    hint: 'ê¸ì •ì˜ ëŒ€ë‹µì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã„ã„ãˆ',
                    romaji: 'iie',
                    pronunciation: 'ì´ì´ì—',
                    korean: 'ì•„ë‹ˆìš”',
                    hint: 'ë¶€ì •ì˜ ëŒ€ë‹µì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã‹ã‚Šã¾ã—ãŸ',
                    romaji: 'wakarimashita',
                    pronunciation: 'ì™€ì¹´ë¦¬ë§ˆì‹œíƒ€',
                    korean: 'ì•Œê² ìŠµë‹ˆë‹¤',
                    hint: 'ì´í•´í–ˆìŒì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã©ã†ã„ãŸã—ã¾ã—ã¦',
                    romaji: 'douitashimashite',
                    pronunciation: 'ë„-ì´íƒ€ì‹œë§ˆì‹œí…Œ',
                    korean: 'ì²œë§Œì—ìš”',
                    hint: 'ê°ì‚¬ì— ëŒ€í•œ ì‘ë‹µì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã˜ã‚ƒã‚ã­',
                    romaji: 'jaane',
                    pronunciation: 'ìŸˆ-ë„¤',
                    korean: 'ê·¸ëŸ¼ ì•ˆë…•',
                    hint: 'ì¹œêµ¬ì™€ í—¤ì–´ì§ˆ ë•Œ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã™ã¿ã¾ã›ã‚“',
                    romaji: 'sumimasen',
                    pronunciation: 'ìŠ¤ë¯¸ë§ˆì„¼',
                    korean: 'ì‹¤ë¡€í•©ë‹ˆë‹¤',
                    hint: 'ì‚¬ëŒì„ ë¶€ë¥¼ ë•Œë‚˜ ì‚¬ê³¼í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŸã ã„ã¾',
                    romaji: 'tadaima',
                    pronunciation: 'íƒ€ë‹¤ì´ë§ˆ',
                    korean: 'ë‹¤ë…€ì™”ìŠµë‹ˆë‹¤',
                    hint: 'ì§‘ì— ëŒì•„ì™”ì„ ë•Œ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã‹ãˆã‚Š',
                    romaji: 'okaeri',
                    pronunciation: 'ì˜¤ì¹´ì—ë¦¬',
                    korean: 'ì–´ì„œ ì™€',
                    hint: 'ëŒì•„ì˜¨ ì‚¬ëŒì„ ë§ì´í•  ë•Œ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã„ã£ã¦ãã¾ã™',
                    romaji: 'ittekimasu',
                    pronunciation: 'ì‡í…Œí‚¤ë§ˆìŠ¤',
                    korean: 'ë‹¤ë…€ì˜¤ê² ìŠµë‹ˆë‹¤',
                    hint: 'ì™¸ì¶œí•  ë•Œ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã„ã£ã¦ã‚‰ã£ã—ã‚ƒã„',
                    romaji: 'itterasshai',
                    pronunciation: 'ì‡í…Œëìƒ¤ì´',
                    korean: 'ë‹¤ë…€ì˜¤ì„¸ìš”',
                    hint: 'ì™¸ì¶œí•˜ëŠ” ì‚¬ëŒì—ê²Œ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã„ãŸã ãã¾ã™',
                    romaji: 'itadakimasu',
                    pronunciation: 'ì´íƒ€ë‹¤í‚¤ë§ˆìŠ¤',
                    korean: 'ì˜ ë¨¹ê² ìŠµë‹ˆë‹¤',
                    hint: 'ì‹ì‚¬ë¥¼ ì‹œì‘í•˜ê¸° ì „ì— í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã”ã¡ãã†ã•ã¾',
                    romaji: 'gochisousama',
                    pronunciation: 'ê³ ì¹˜ì†Œ-ì‚¬ë§ˆ',
                    korean: 'ì˜ ë¨¹ì—ˆìŠµë‹ˆë‹¤',
                    hint: 'ì‹ì‚¬ë¥¼ ë§ˆì¹œ í›„ í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã‚ã§ã¨ã†',
                    romaji: 'omedetou',
                    pronunciation: 'ì˜¤ë©”ë°ë˜',
                    korean: 'ì¶•í•˜í•´ìš”',
                    hint: 'ì¶•í•˜í•  ì¼ì´ ìˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŒã‚“ã°ã£ã¦',
                    romaji: 'ganbatte',
                    pronunciation: 'ê°„ë°§í…Œ',
                    korean: 'í˜ë‚´',
                    hint: 'ì‘ì›í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã ã„ã˜ã‚‡ã†ã¶',
                    romaji: 'daijoubu',
                    pronunciation: 'ë‹¤ì´ì£ -ë¶€',
                    korean: 'ê´œì°®ì•„ìš”',
                    hint: 'ê´œì°®ë‹¤ëŠ” ì˜ë¯¸ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã™ã¦ã',
                    romaji: 'suteki',
                    pronunciation: 'ìŠ¤í…Œí‚¤',
                    korean: 'ë©‹ì ¸ìš”',
                    hint: 'ë©‹ì§€ê±°ë‚˜ í›Œë¥­í•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‹ã‚ã„ã„',
                    romaji: 'kawaii',
                    pronunciation: 'ì¹´ì™€ì´ì´',
                    korean: 'ê·€ì—¬ì›Œ',
                    hint: 'ê·€ì—½ë‹¤ëŠ” ì˜ë¯¸ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã™ã”ã„',
                    romaji: 'sugoi',
                    pronunciation: 'ìŠ¤ê³ ì´',
                    korean: 'ëŒ€ë‹¨í•´',
                    hint: 'ë†€ëê±°ë‚˜ ëŒ€ë‹¨í•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŸã®ã—ã„',
                    romaji: 'tanoshii',
                    pronunciation: 'íƒ€ë…¸ì‹œì´',
                    korean: 'ì¦ê±°ì›Œ',
                    hint: 'ì¦ê²ë‹¤ëŠ” ê°ì •ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã†ã‚Œã—ã„',
                    romaji: 'ureshii',
                    pronunciation: 'ìš°ë ˆì‹œì´',
                    korean: 'ê¸°ë»',
                    hint: 'ê¸°ì˜ë‹¤ëŠ” ê°ì •ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã•ã³ã—ã„',
                    romaji: 'sabishii',
                    pronunciation: 'ì‚¬ë¹„ì‹œì´',
                    korean: 'ì™¸ë¡œì›Œ',
                    hint: 'ì™¸ë¡­ë‹¤ëŠ” ê°ì •ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¤ã‹ã‚ŒãŸ',
                    romaji: 'tsukareta',
                    pronunciation: 'ì¸ ì¹´ë ˆíƒ€',
                    korean: 'í”¼ê³¤í•´',
                    hint: 'í”¼ê³¤í•˜ë‹¤ëŠ” ìƒíƒœë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã­ã‚€ã„',
                    romaji: 'nemui',
                    pronunciation: 'ë„¤ë¬´ì´',
                    korean: 'ì¡¸ë ¤',
                    hint: 'ì¡¸ë¦¬ë‹¤ëŠ” ìƒíƒœë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã„ã—ã„',
                    romaji: 'oishii',
                    pronunciation: 'ì˜¤ì´ì‹œì´',
                    korean: 'ë§›ìˆì–´',
                    hint: 'ìŒì‹ì´ ë§›ìˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¾ãšã„',
                    romaji: 'mazui',
                    pronunciation: 'ë§ˆì¦ˆì´',
                    korean: 'ë§›ì—†ì–´',
                    hint: 'ìŒì‹ì´ ë§›ì—†ì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã¤ã„',
                    romaji: 'atsui',
                    pronunciation: 'ì•„ì¸ ì´',
                    korean: 'ë”ì›Œ/ëœ¨ê±°ì›Œ',
                    hint: 'ë‚ ì”¨ê°€ ë¥ê±°ë‚˜ ë¬¼ê±´ì´ ëœ¨ê±°ìš¸ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã•ã‚€ã„',
                    romaji: 'samui',
                    pronunciation: 'ì‚¬ë¬´ì´',
                    korean: 'ì¶”ì›Œ',
                    hint: 'ë‚ ì”¨ê°€ ì¶”ìš¸ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŸã‹ã„',
                    romaji: 'takai',
                    pronunciation: 'íƒ€ì¹´ì´',
                    korean: 'ë¹„ì‹¸/ë†’ì•„',
                    hint: 'ê°€ê²©ì´ ë¹„ì‹¸ê±°ë‚˜ ë†’ì´ê°€ ë†’ì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚„ã™ã„',
                    romaji: 'yasui',
                    pronunciation: 'ì•¼ìŠ¤ì´',
                    korean: 'ì‹¸',
                    hint: 'ê°€ê²©ì´ ìŒ€ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠãŠãã„',
                    romaji: 'ookii',
                    pronunciation: 'ì˜¤-í‚¤ì´',
                    korean: 'ì»¤',
                    hint: 'í¬ê¸°ê°€ í´ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¡ã„ã•ã„',
                    romaji: 'chiisai',
                    pronunciation: 'ì¹˜-ì‚¬ì´',
                    korean: 'ì‘ì•„',
                    hint: 'í¬ê¸°ê°€ ì‘ì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ãŸã‚‰ã—ã„',
                    romaji: 'atarashii',
                    pronunciation: 'ì•„íƒ€ë¼ì‹œì´',
                    korean: 'ìƒˆë¡œì›Œ',
                    hint: 'ìƒˆê²ƒì¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãµã‚‹ã„',
                    romaji: 'furui',
                    pronunciation: 'í›„ë£¨ì´',
                    korean: 'ì˜¤ë˜ëì–´',
                    hint: 'ì˜¤ë˜ëœ ê²ƒì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã„ã„',
                    romaji: 'ii',
                    pronunciation: 'ì´-',
                    korean: 'ì¢‹ì•„',
                    hint: 'ì¢‹ë‹¤ëŠ” ì˜ë¯¸ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã‚‹ã„',
                    romaji: 'warui',
                    pronunciation: 'ì™€ë£¨ì´',
                    korean: 'ë‚˜ë¹ ',
                    hint: 'ë‚˜ì˜ë‹¤ëŠ” ì˜ë¯¸ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚€ãšã‹ã—ã„',
                    romaji: 'muzukashii',
                    pronunciation: 'ë¬´ì¦ˆì¹´ì‹œì´',
                    korean: 'ì–´ë ¤ì›Œ',
                    hint: 'ì–´ë µë‹¤ëŠ” ì˜ë¯¸ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚„ã•ã—ã„',
                    romaji: 'yasashii',
                    pronunciation: 'ì•¼ì‚¬ì‹œì´',
                    korean: 'ì‰¬ì›Œ/ì¹œì ˆí•´',
                    hint: 'ì‰½ê±°ë‚˜ ì¹œì ˆí•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¯ã‚„ã„',
                    romaji: 'hayai',
                    pronunciation: 'í•˜ì•¼ì´',
                    korean: 'ë¹¨ë¼',
                    hint: 'ì†ë„ê°€ ë¹ ë¥´ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠãã„',
                    romaji: 'osoi',
                    pronunciation: 'ì˜¤ì†Œì´',
                    korean: 'ëŠë ¤',
                    hint: 'ì†ë„ê°€ ëŠë¦¬ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŸãã•ã‚“',
                    romaji: 'takusan',
                    pronunciation: 'íƒ€ì¿ ìƒ',
                    korean: 'ë§ì´',
                    hint: 'ë§ë‹¤ëŠ” ì˜ë¯¸ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã™ã“ã—',
                    romaji: 'sukoshi',
                    pronunciation: 'ìŠ¤ì½”ì‹œ',
                    korean: 'ì¡°ê¸ˆ',
                    hint: 'ì ì€ ì–‘ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¨ã¦ã‚‚',
                    romaji: 'totemo',
                    pronunciation: 'í† í…Œëª¨',
                    korean: 'ë§¤ìš°',
                    hint: 'ì •ë„ê°€ ì‹¬í•¨ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¡ã‚‡ã£ã¨',
                    romaji: 'chotto',
                    pronunciation: 'ì´›í† ',
                    korean: 'ì ê¹',
                    hint: 'ì§§ì€ ì‹œê°„ì´ë‚˜ ì ì€ ì–‘ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                }
            ],
            basic: [
                {
                    japanese: 'ã‚ãŸã—ã¯ ãŒãã›ã„ ã§ã™',
                    romaji: 'watashi wa gakusei desu',
                    pronunciation: 'ì™€íƒ€ì‹œì™€ ê°€ì¿ ì„¸-ë°ìŠ¤',
                    korean: 'ì €ëŠ” í•™ìƒì…ë‹ˆë‹¤',
                    hint: 'ìê¸°ì†Œê°œì˜ ê¸°ë³¸ ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã“ã‚Œã¯ ã»ã‚“ ã§ã™',
                    romaji: 'kore wa hon desu',
                    pronunciation: 'ì½”ë ˆì™€ í˜¼ë°ìŠ¤',
                    korean: 'ì´ê²ƒì€ ì±…ì…ë‹ˆë‹¤',
                    hint: 'ì‚¬ë¬¼ì„ ê°€ë¦¬í‚¬ ë•Œ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãªã¾ãˆã¯ ãªã‚“ ã§ã™ã‹',
                    romaji: 'namae wa nan desuka',
                    pronunciation: 'ë‚˜ë§ˆì—ì™€ ë‚œë°ìŠ¤ì¹´',
                    korean: 'ì´ë¦„ì´ ë¬´ì—‡ì…ë‹ˆê¹Œ?',
                    hint: 'ìƒëŒ€ë°©ì˜ ì´ë¦„ì„ ë¬¼ì–´ë³´ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã™ã¿ã¾ã›ã‚“',
                    romaji: 'sumimasen',
                    pronunciation: 'ìŠ¤ë¯¸ë§ˆì„¼',
                    korean: 'ì£„ì†¡í•©ë‹ˆë‹¤ / ì‹¤ë¡€í•©ë‹ˆë‹¤',
                    hint: 'ì‚¬ê³¼í•˜ê±°ë‚˜ ì£¼ì˜ë¥¼ ëŒ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã„ãŸã ãã¾ã™',
                    romaji: 'itadakimasu',
                    pronunciation: 'ì´íƒ€ë‹¤í‚¤ë§ˆìŠ¤',
                    korean: 'ì˜ ë¨¹ê² ìŠµë‹ˆë‹¤',
                    hint: 'ì‹ì‚¬ ì „ì— í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã”ã¡ãã†ã•ã¾ã§ã—ãŸ',
                    romaji: 'gochisousamadeshita',
                    pronunciation: 'ê³ ì¹˜ì†Œ-ì‚¬ë§ˆë°ì‹œíƒ€',
                    korean: 'ì˜ ë¨¹ì—ˆìŠµë‹ˆë‹¤',
                    hint: 'ì‹ì‚¬ í›„ì— í•˜ëŠ” ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ãŸã—ã¯ ã«ã»ã‚“ã˜ã‚“ ã§ã™',
                    romaji: 'watashi wa nihonjin desu',
                    pronunciation: 'ì™€íƒ€ì‹œì™€ ë‹ˆí˜¼ì§„ë°ìŠ¤',
                    korean: 'ì €ëŠ” ì¼ë³¸ì¸ì…ë‹ˆë‹¤',
                    hint: 'êµ­ì ì„ ë§í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã“ã‚Œã¯ ã„ãã‚‰ ã§ã™ã‹',
                    romaji: 'kore wa ikura desuka',
                    pronunciation: 'ì½”ë ˆì™€ ì´ì¿ ë¼ë°ìŠ¤ì¹´',
                    korean: 'ì´ê²ƒì€ ì–¼ë§ˆì…ë‹ˆê¹Œ?',
                    hint: 'ê°€ê²©ì„ ë¬¼ì–´ë³¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã™ãã§ã™',
                    romaji: 'suki desu',
                    pronunciation: 'ìŠ¤í‚¤ë°ìŠ¤',
                    korean: 'ì¢‹ì•„í•©ë‹ˆë‹¤',
                    hint: 'ì¢‹ì•„í•˜ëŠ” ê²ƒì„ í‘œí˜„í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã‹ã‚Šã¾ã›ã‚“',
                    romaji: 'wakarimasen',
                    pronunciation: 'ì™€ì¹´ë¦¬ë§ˆì„¼',
                    korean: 'ëª¨ë¥´ê² ìŠµë‹ˆë‹¤',
                    hint: 'ì´í•´í•˜ì§€ ëª»í–ˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã«ã»ã‚“ã”ãŒ ã¯ãªã›ã¾ã™',
                    romaji: 'nihongo ga hanasemasu',
                    pronunciation: 'ë‹ˆí˜¼ê³ ê°€ í•˜ë‚˜ì„¸ë§ˆìŠ¤',
                    korean: 'ì¼ë³¸ì–´ë¥¼ ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                    hint: 'ëŠ¥ë ¥ì„ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãƒˆã‚¤ãƒ¬ã¯ ã©ã“ ã§ã™ã‹',
                    romaji: 'toire wa doko desuka',
                    pronunciation: 'í† ì´ë ˆì™€ ë„ì½”ë°ìŠ¤ì¹´',
                    korean: 'í™”ì¥ì‹¤ì€ ì–´ë””ì…ë‹ˆê¹Œ?',
                    hint: 'í™”ì¥ì‹¤ ìœ„ì¹˜ë¥¼ ë¬¼ì–´ë³¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‹ã‚“ã“ãã˜ã‚“ ã§ã™',
                    romaji: 'kankokujin desu',
                    pronunciation: 'ì¹¸ì½”ì¿ ì§„ë°ìŠ¤',
                    korean: 'í•œêµ­ì¸ì…ë‹ˆë‹¤',
                    hint: 'êµ­ì ì„ ë§í•˜ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã“ã‚Œã‚’ ãã ã•ã„',
                    romaji: 'kore wo kudasai',
                    pronunciation: 'ì½”ë ˆì˜¤ ì¿ ë‹¤ì‚¬ì´',
                    korean: 'ì´ê²ƒì„ ì£¼ì„¸ìš”',
                    hint: 'ë¬¼ê±´ì„ ìš”ì²­í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠã„ã—ã„ ã§ã™',
                    romaji: 'oishii desu',
                    pronunciation: 'ì˜¤ì´ì‹œ-ë°ìŠ¤',
                    korean: 'ë§›ìˆìŠµë‹ˆë‹¤',
                    hint: 'ìŒì‹ì´ ë§›ìˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                }
            ],
            intermediate: [
                {
                    japanese: 'ãã‚‡ã†ã¯ ã„ã„ ã¦ã‚“ã ã§ã™ã­',
                    romaji: 'kyou wa ii tenki desune',
                    pronunciation: 'ì¿„-ì™€ ì´- í…í‚¤ë°ìŠ¤ë„¤',
                    korean: 'ì˜¤ëŠ˜ì€ ì¢‹ì€ ë‚ ì”¨ë„¤ìš”',
                    hint: 'ë‚ ì”¨ì— ëŒ€í•´ ì´ì•¼ê¸°í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã«ã»ã‚“ã”ã‚’ ã¹ã‚“ãã‚‡ã†ã—ã¦ ã„ã¾ã™',
                    romaji: 'nihongo wo benkyou shite imasu',
                    pronunciation: 'ë‹ˆí˜¼ê³ ì˜¤ ë²¤ì¿„-ì‹œí…Œì´ë§ˆìŠ¤',
                    korean: 'ì¼ë³¸ì–´ë¥¼ ê³µë¶€í•˜ê³  ìˆìŠµë‹ˆë‹¤',
                    hint: 'í˜„ì¬ ì§„í–‰ ì¤‘ì¸ í–‰ë™ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãˆãã¯ ã©ã“ ã§ã™ã‹',
                    romaji: 'eki wa doko desuka',
                    pronunciation: 'ì—í‚¤ì™€ ë„ì½”ë°ìŠ¤ì¹´',
                    korean: 'ì—­ì€ ì–´ë””ì…ë‹ˆê¹Œ?',
                    hint: 'ì¥ì†Œë¥¼ ë¬¼ì–´ë³¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŠãªã‹ãŒ ã™ãã¾ã—ãŸ',
                    romaji: 'onaka ga sukimashita',
                    pronunciation: 'ì˜¤ë‚˜ì¹´ê°€ ìŠ¤í‚¤ë§ˆì‹œíƒ€',
                    korean: 'ë°°ê°€ ê³ íŒŒìš”',
                    hint: 'ë°°ê³ í””ì„ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¾ãŸ ã‚ã—ãŸ',
                    romaji: 'mata ashita',
                    pronunciation: 'ë§ˆíƒ€ ì•„ì‹œíƒ€',
                    korean: 'ë˜ ë‚´ì¼ ë´ìš”',
                    hint: 'ì¹œê·¼í•œ ì‘ë³„ ì¸ì‚¬ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãŸã®ã—ã‹ã£ãŸ ã§ã™',
                    romaji: 'tanoshikatta desu',
                    pronunciation: 'íƒ€ë…¸ì‹œìº‡íƒ€ë°ìŠ¤',
                    korean: 'ì¦ê±°ì› ìŠµë‹ˆë‹¤',
                    hint: 'ê³¼ê±°ì˜ ì¦ê±°ì› ë˜ ê²½í—˜ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¦ã¤ã ã£ã¦ ãã ã•ã„',
                    romaji: 'tetsudatte kudasai',
                    pronunciation: 'í…Œì¸ ë‹·í…Œ ì¿ ë‹¤ì‚¬ì´',
                    korean: 'ë„ì™€ì£¼ì„¸ìš”',
                    hint: 'ë„ì›€ì„ ìš”ì²­í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚†ã£ãã‚Š ã¯ãªã—ã¦ ãã ã•ã„',
                    romaji: 'yukkuri hanashite kudasai',
                    pronunciation: 'ìœ³ì¿ ë¦¬ í•˜ë‚˜ì‹œí…Œ ì¿ ë‹¤ì‚¬ì´',
                    korean: 'ì²œì²œíˆ ë§í•´ ì£¼ì„¸ìš”',
                    hint: 'ì²œì²œíˆ ë§í•´ë‹¬ë¼ê³  ë¶€íƒí•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã«ã»ã‚“ã« ã„ããŸã„ ã§ã™',
                    romaji: 'nihon ni ikitai desu',
                    pronunciation: 'ë‹ˆí˜¼ë‹ˆ ì´í‚¤íƒ€ì´ë°ìŠ¤',
                    korean: 'ì¼ë³¸ì— ê°€ê³  ì‹¶ìŠµë‹ˆë‹¤',
                    hint: 'í¬ë§ì„ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ãˆã„ãŒã‚’ ã¿ã« ã„ãã¾ã™',
                    romaji: 'eiga wo mi ni ikimasu',
                    pronunciation: 'ì—-ê°€ì˜¤ ë¯¸ë‹ˆ ì´í‚¤ë§ˆìŠ¤',
                    korean: 'ì˜í™”ë¥¼ ë³´ëŸ¬ ê°‘ë‹ˆë‹¤',
                    hint: 'ëª©ì ì„ ê°€ì§„ ì´ë™ì„ í‘œí˜„í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã—ã‚…ã†ã¾ã¤ã¯ ãªã«ã‚’ ã—ã¾ã™ã‹',
                    romaji: 'shuumatsu wa nani wo shimasuka',
                    pronunciation: 'ìŠˆ-ë§ˆì¸ ì™€ ë‚˜ë‹ˆì˜¤ ì‹œë§ˆìŠ¤ì¹´',
                    korean: 'ì£¼ë§ì— ë¬´ì—‡ì„ í•©ë‹ˆê¹Œ?',
                    hint: 'ê³„íšì„ ë¬¼ì–´ë³´ëŠ” í‘œí˜„ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã¨ã¦ã‚‚ ãã‚Œã„ ã§ã™',
                    romaji: 'totemo kirei desu',
                    pronunciation: 'í† í…Œëª¨ í‚¤ë ˆì´ë°ìŠ¤',
                    korean: 'ë§¤ìš° ì˜ˆì©ë‹ˆë‹¤',
                    hint: 'ì•„ë¦„ë‹¤ì›€ì„ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ì…ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚ã—ãŸã¯ ã‚„ã™ã¿ ã§ã™',
                    romaji: 'ashita wa yasumi desu',
                    pronunciation: 'ì•„ì‹œíƒ€ì™€ ì•¼ìŠ¤ë¯¸ë°ìŠ¤',
                    korean: 'ë‚´ì¼ì€ ì‰¬ëŠ” ë‚ ì…ë‹ˆë‹¤',
                    hint: 'íœ´ì¼ì„ ë§í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã‚‚ã† ã„ã¡ã© ã„ã£ã¦ ãã ã•ã„',
                    romaji: 'mou ichido itte kudasai',
                    pronunciation: 'ëª¨- ì´ì¹˜ë„ ì‡í…Œ ì¿ ë‹¤ì‚¬ì´',
                    korean: 'í•œ ë²ˆ ë” ë§í•´ ì£¼ì„¸ìš”',
                    hint: 'ë‹¤ì‹œ ë§í•´ë‹¬ë¼ê³  ë¶€íƒí•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                },
                {
                    japanese: 'ã§ã‚“ã‚ã°ã‚“ã”ã†ã‚’ ãŠã—ãˆã¦ ãã ã•ã„',
                    romaji: 'denwabangou wo oshiete kudasai',
                    pronunciation: 'ë´ì™€ë°©ê³ -ì˜¤ ì˜¤ì‹œì—í…Œ ì¿ ë‹¤ì‚¬ì´',
                    korean: 'ì „í™”ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”',
                    hint: 'ì—°ë½ì²˜ë¥¼ ë¬¼ì–´ë³¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.'
                }
            ]
        };

        let currentLevel = 'beginner';
        let currentIndex = 0;
        let isDrawing = false;
        let showGuide = false;

        const canvas = document.getElementById('drawingCanvas');
        const guideCanvas = document.getElementById('guideCanvas');
        const ctx = canvas.getContext('2d');
        const guideCtx = guideCanvas.getContext('2d');

        function initCanvas() {
            const container = canvas.parentElement;
            const rect = container.getBoundingClientRect();
            
            canvas.width = rect.width;
            canvas.height = 250;
            guideCanvas.width = rect.width;
            guideCanvas.height = 250;

            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = '#4facfe';

            drawGuideSentence();
        }

        function drawGuideSentence() {
            const sentence = sentences[currentLevel][currentIndex];
            guideCtx.clearRect(0, 0, guideCanvas.width, guideCanvas.height);
            
            // ê³µë°± ì œê±°í•œ ìˆœìˆ˜ ë¬¸ìì—´
            const noSpace = sentence.japanese.replace(/\s/g, '');
            const totalChars = noSpace.length;
            let lines = [];
            
            if (totalChars <= 6) {
                // 6ê¸€ì ì´í•˜: 1ì¤„
                lines = [sentence.japanese];
            } else if (totalChars <= 12) {
                // 7~12ê¸€ì: 2ì¤„ (ë°˜ìœ¼ë¡œ ë‚˜ëˆ„ê¸°)
                const firstLineChars = Math.ceil(totalChars / 2);
                let currentLine = '';
                let charCount = 0;
                
                for (let i = 0; i < sentence.japanese.length; i++) {
                    const char = sentence.japanese[i];
                    if (char === ' ') {
                        currentLine += char;
                    } else {
                        if (charCount === firstLineChars) {
                            lines.push(currentLine.trim());
                            currentLine = '';
                        }
                        currentLine += char;
                        charCount++;
                    }
                }
                if (currentLine.trim()) {
                    lines.push(currentLine.trim());
                }
            } else {
                // 13ê¸€ì ì´ìƒ: 3ì¤„ (3ë“±ë¶„)
                const charsPerLine = Math.ceil(totalChars / 3);
                let currentLine = '';
                let charCount = 0;
                let lineCount = 0;
                
                for (let i = 0; i < sentence.japanese.length; i++) {
                    const char = sentence.japanese[i];
                    if (char === ' ') {
                        currentLine += char;
                    } else {
                        if (charCount > 0 && charCount % charsPerLine === 0 && lineCount < 2) {
                            lines.push(currentLine.trim());
                            currentLine = '';
                            lineCount++;
                        }
                        currentLine += char;
                        charCount++;
                    }
                }
                if (currentLine.trim()) {
                    lines.push(currentLine.trim());
                }
            }
            
            // í°íŠ¸ í¬ê¸° ê³„ì‚° (ê°€ì¥ ê¸´ ì¤„ ê¸°ì¤€)
            let fontSize = 100;
            guideCtx.font = `bold ${fontSize}px sans-serif`;
            const longestLine = lines.reduce((a, b) => a.length > b.length ? a : b);
            let textWidth = guideCtx.measureText(longestLine).width;
            
            const targetWidth = guideCanvas.width * 0.9;
            fontSize = fontSize * (targetWidth / textWidth);
            
            // ì—¬ëŸ¬ ì¤„ì¼ ë•Œ ë†’ì´ë„ ê³ ë ¤
            const lineHeight = fontSize * 1.3;
            const totalHeight = lineHeight * lines.length;
            const maxHeight = guideCanvas.height * 0.85;
            if (totalHeight > maxHeight) {
                fontSize = fontSize * (maxHeight / totalHeight);
            }
            
            guideCtx.font = `bold ${fontSize}px sans-serif`;
            guideCtx.fillStyle = '#00f2fe';
            guideCtx.textAlign = 'center';
            guideCtx.textBaseline = 'middle';
            
            const actualLineHeight = fontSize * 1.3;
            const startY = guideCanvas.height / 2 - (actualLineHeight * (lines.length - 1)) / 2;
            
            lines.forEach((line, index) => {
                guideCtx.fillText(line, guideCanvas.width / 2, startY + index * actualLineHeight);
            });
        }

        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches ? e.touches[0] : e;
            return {
                x: touch.clientX - rect.left,
                y: touch.clientY - rect.top
            };
        }

        function startDrawing(e) {
            e.preventDefault();
            isDrawing = true;
            const pos = getPos(e);
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function toggleGuide() {
            showGuide = !showGuide;
            guideCanvas.style.opacity = showGuide ? '0.3' : '0';
        }

        function nextSentence() {
            const levelData = sentences[currentLevel];
            currentIndex = (currentIndex + 1) % levelData.length;
            updateDisplay();
            clearCanvas();
            drawGuideSentence();
        }

        function prevSentence() {
            const levelData = sentences[currentLevel];
            currentIndex = (currentIndex - 1 + levelData.length) % levelData.length;
            updateDisplay();
            clearCanvas();
            drawGuideSentence();
        }

        function selectLevel(level) {
            currentLevel = level;
            currentIndex = 0;
            
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateDisplay();
            clearCanvas();
            drawGuideSentence();
        }

        function updateDisplay() {
            const sentence = sentences[currentLevel][currentIndex];
            const japaneseEl = document.getElementById('japaneseSentence');
            
            // ê¸€ì ìˆ˜ì— ë”°ë¼ í°íŠ¸ í¬ê¸° ì¡°ì ˆ (2ì¤„ ì•ˆì— ë“¤ì–´ê°€ë„ë¡)
            const noSpace = sentence.japanese.replace(/\s/g, '');
            const charCount = noSpace.length;
            let fontSize;
            
            if (charCount <= 6) {
                fontSize = 28;
            } else if (charCount <= 10) {
                fontSize = 24;
            } else if (charCount <= 14) {
                fontSize = 20;
            } else {
                fontSize = 17;
            }
            
            japaneseEl.style.fontSize = fontSize + 'px';
            japaneseEl.textContent = sentence.japanese;
            
            document.getElementById('romajiText').textContent = sentence.romaji;
            document.getElementById('koreanPronunciation').textContent = sentence.pronunciation;
            document.getElementById('koreanTranslation').textContent = sentence.korean;
            document.getElementById('hintContent').textContent = sentence.hint;
            document.getElementById('progressText').textContent = 
                `${currentIndex + 1} / ${sentences[currentLevel].length}`;
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        // Event listeners
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', stopDrawing);

        window.addEventListener('resize', initCanvas);
        
        initCanvas();
        updateDisplay();
    </script>
</body>
</html>
